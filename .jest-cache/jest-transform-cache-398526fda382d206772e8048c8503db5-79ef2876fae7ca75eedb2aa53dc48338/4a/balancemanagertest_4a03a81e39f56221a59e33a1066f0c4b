26f8caa61563999648b72a2092d195cf
"use strict";
/**
 * =============================================================================
 * BALANCE MANAGER TESTS
 * =============================================================================
 *
 * Comprehensive test suite for the balance management system with real-time
 * monitoring, validation, discrepancy detection, and reconciliation.
 *
 * @author AI Crypto Trading System
 * @version 1.0.0
 * @license PROPRIETARY
 * =============================================================================
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../../api/gate-io-client');
jest.mock('@/security/audit-service');
jest.mock('@/core/logging/logger');
const balance_manager_1 = require("../balance-manager");
const gate_io_client_1 = require("../../api/gate-io-client");
const audit_service_1 = require("@/security/audit-service");
const MockedGateIOClient = gate_io_client_1.GateIOClient;
const MockedAuditService = audit_service_1.AuditService;
describe('BalanceManager', () => {
    let balanceManager;
    let mockGateIOClient;
    let mockAuditService;
    // Sample data
    const sampleSpotAccounts = [
        {
            currency: 'BTC',
            available: '0.5',
            locked: '0.1',
        },
        {
            currency: 'ETH',
            available: '2.0',
            locked: '0.5',
        },
        {
            currency: 'USDT',
            available: '1000.0',
            locked: '200.0',
        },
    ];
    const sampleTradeHistory = [
        {
            id: 'trade-1',
            create_time: '2024-01-01T00:00:00Z',
            create_time_ms: '1704067200000',
            currency_pair: 'BTC_USDT',
            side: 'buy',
            role: 'taker',
            amount: '0.1',
            price: '50000',
            order_id: 'order-1',
            fee: '0.001',
            fee_currency: 'BTC',
            point_fee: '0',
            gt_fee: '0',
        },
    ];
    beforeEach(() => {
        jest.clearAllMocks();
        // Mock GateIO client
        mockGateIOClient = new MockedGateIOClient();
        mockGateIOClient.makeRequest = jest.fn();
        // Mock audit service
        mockAuditService = new MockedAuditService();
        mockAuditService.logSecurityEvent = jest.fn().mockResolvedValue(undefined);
        // Create balance manager instance
        balanceManager = new balance_manager_1.BalanceManager(mockGateIOClient);
    });
    describe('Initialization', () => {
        it('should initialize successfully with default configuration', async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts) // Load balances
                .mockResolvedValueOnce(sampleTradeHistory); // Load trade history
            const result = await balanceManager.initialize();
            expect(result).toBe(true);
            expect(mockAuditService.logSecurityEvent).toHaveBeenCalledWith(expect.objectContaining({
                type: 'BALANCE_MANAGER_INITIALIZED',
                severity: 'INFO'
            }));
        });
        it('should initialize with custom configuration', async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            const customConfig = {
                monitoringInterval: 60000,
                enableAlerts: false,
            };
            const result = await balanceManager.initialize(customConfig);
            expect(result).toBe(true);
            const config = balanceManager.getConfig();
            expect(config.monitoringInterval).toBe(60000);
            expect(config.enableAlerts).toBe(false);
        });
        it('should handle initialization failure gracefully', async () => {
            mockGateIOClient.makeRequest.mockRejectedValue(new Error('API error'));
            const result = await balanceManager.initialize();
            expect(result).toBe(false);
            expect(mockAuditService.logSecurityEvent).toHaveBeenCalledWith(expect.objectContaining({
                type: 'BALANCE_MANAGER_INIT_FAILED',
                severity: 'ERROR'
            }));
        });
    });
    describe('Balance Retrieval', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should get current balances', async () => {
            const balances = await balanceManager.getCurrentBalances();
            expect(balances.size).toBe(3);
            expect(balances.has('BTC')).toBe(true);
            expect(balances.has('ETH')).toBe(true);
            expect(balances.has('USDT')).toBe(true);
            const btcBalance = balances.get('BTC');
            expect(btcBalance?.available).toBe('0.5');
            expect(btcBalance?.locked).toBe('0.1');
            expect(btcBalance?.total).toBe('0.6');
        });
        it('should get balance for specific currency', async () => {
            const btcBalance = await balanceManager.getBalance('BTC');
            expect(btcBalance).toBeDefined();
            expect(btcBalance?.currency).toBe('BTC');
            expect(btcBalance?.total).toBe('0.6');
        });
        it('should return null for non-existent currency', async () => {
            const balance = await balanceManager.getBalance('DOGE');
            expect(balance).toBeNull();
        });
        it('should force refresh balances', async () => {
            const updatedAccounts = [
                { currency: 'BTC', available: '0.7', locked: '0.1' },
            ];
            mockGateIOClient.makeRequest.mockResolvedValueOnce(updatedAccounts);
            const balances = await balanceManager.getCurrentBalances(true);
            expect(mockGateIOClient.makeRequest).toHaveBeenCalledWith(expect.objectContaining({
                method: 'GET',
                url: '/spot/accounts'
            }));
            const btcBalance = balances.get('BTC');
            expect(btcBalance?.total).toBe('0.8');
        });
    });
    describe('Portfolio Value Calculation', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should calculate total portfolio value', async () => {
            // Mock price requests
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '50000' }]) // BTC price
                .mockResolvedValueOnce([{ last: '3000' }]); // ETH price
            const totalValue = await balanceManager.getTotalPortfolioValue();
            // BTC: 0.6 * 50000 = 30000
            // ETH: 2.5 * 3000 = 7500
            // USDT: 1200 * 1 = 1200
            // Total: 38700
            expect(totalValue).toBe(38700);
        });
        it('should handle price fetch errors gracefully', async () => {
            mockGateIOClient.makeRequest.mockRejectedValue(new Error('Price API error'));
            const totalValue = await balanceManager.getTotalPortfolioValue();
            expect(totalValue).toBe(0);
        });
    });
    describe('Balance Validation and Discrepancy Detection', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should detect no discrepancies when balances match', async () => {
            mockGateIOClient.makeRequest.mockResolvedValueOnce(sampleSpotAccounts);
            const discrepancies = await balanceManager.validateBalances();
            expect(discrepancies).toHaveLength(0);
        });
        it('should detect discrepancies when balances differ', async () => {
            const modifiedAccounts = [
                { currency: 'BTC', available: '0.4', locked: '0.1' }, // Different from cached
                { currency: 'ETH', available: '2.0', locked: '0.5' },
                { currency: 'USDT', available: '1000.0', locked: '200.0' },
            ];
            mockGateIOClient.makeRequest.mockResolvedValueOnce(modifiedAccounts);
            const discrepancies = await balanceManager.validateBalances();
            expect(discrepancies.length).toBeGreaterThan(0);
            const btcDiscrepancy = discrepancies.find(d => d.currency === 'BTC');
            expect(btcDiscrepancy).toBeDefined();
            expect(btcDiscrepancy?.hasDiscrepancy).toBe(true);
            expect(btcDiscrepancy?.expectedBalance).toBe(0.6);
            expect(btcDiscrepancy?.actualBalance).toBe(0.5);
        });
        it('should validate specific currency', async () => {
            const modifiedAccounts = [
                { currency: 'BTC', available: '0.4', locked: '0.1' },
            ];
            mockGateIOClient.makeRequest.mockResolvedValueOnce(modifiedAccounts);
            const discrepancies = await balanceManager.validateBalances('BTC');
            expect(discrepancies).toHaveLength(1);
            expect(discrepancies[0].currency).toBe('BTC');
        });
        it('should classify discrepancy severity correctly', async () => {
            const modifiedAccounts = [
                { currency: 'BTC', available: '0.1', locked: '0.1' }, // 66% difference - HIGH
            ];
            mockGateIOClient.makeRequest.mockResolvedValueOnce(modifiedAccounts);
            const discrepancies = await balanceManager.validateBalances('BTC');
            expect(discrepancies[0].severity).toBe('HIGH');
        });
    });
    describe('Transaction Reconciliation', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should reconcile transactions successfully', async () => {
            const results = await balanceManager.reconcileTransactions();
            expect(results.length).toBeGreaterThan(0);
            expect(results[0]).toHaveProperty('isReconciled');
            expect(results[0]).toHaveProperty('currency');
            expect(results[0]).toHaveProperty('expectedBalance');
            expect(results[0]).toHaveProperty('actualBalance');
        });
        it('should reconcile specific currency', async () => {
            const results = await balanceManager.reconcileTransactions('BTC');
            expect(results).toHaveLength(1);
            expect(results[0].currency).toBe('BTC');
        });
        it('should detect unreconciled transactions', async () => {
            // This would require more complex setup with mismatched transactions
            const results = await balanceManager.reconcileTransactions();
            expect(results[0]).toHaveProperty('unreconciledTransactions');
            expect(Array.isArray(results[0].unreconciledTransactions)).toBe(true);
        });
    });
    describe('Balance Snapshots', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should create balance snapshot', async () => {
            // Mock portfolio value calculation
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '50000' }]) // BTC price
                .mockResolvedValueOnce([{ last: '3000' }]); // ETH price
            const snapshot = await balanceManager.createBalanceSnapshot();
            expect(snapshot).toHaveProperty('snapshotId');
            expect(snapshot).toHaveProperty('timestamp');
            expect(snapshot).toHaveProperty('balances');
            expect(snapshot).toHaveProperty('totalValueUSD');
            expect(snapshot.balances.size).toBe(3);
        });
        it('should return balance history', async () => {
            // Create a snapshot first
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '50000' }])
                .mockResolvedValueOnce([{ last: '3000' }]);
            await balanceManager.createBalanceSnapshot();
            const history = balanceManager.getBalanceHistory();
            expect(history.length).toBeGreaterThan(0);
            expect(history[0]).toHaveProperty('snapshotId');
            expect(history[0]).toHaveProperty('timestamp');
        });
        it('should limit balance history results', () => {
            const history = balanceManager.getBalanceHistory(5);
            expect(history.length).toBeLessThanOrEqual(5);
        });
    });
    describe('Balance Alerts', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should set balance alert', () => {
            const result = balanceManager.setBalanceAlert('BTC', 'LOW_BALANCE', 0.1);
            expect(result).toBe(true);
            const alerts = balanceManager.getBalanceAlerts('BTC');
            expect(alerts.length).toBeGreaterThan(0);
            const lowBalanceAlert = alerts.find(a => a.alertType === 'LOW_BALANCE');
            expect(lowBalanceAlert).toBeDefined();
            expect(lowBalanceAlert?.threshold).toBe(0.1);
        });
        it('should remove balance alert', () => {
            balanceManager.setBalanceAlert('BTC', 'LOW_BALANCE', 0.1);
            const result = balanceManager.removeBalanceAlert('BTC', 'LOW_BALANCE');
            expect(result).toBe(true);
            const alerts = balanceManager.getBalanceAlerts('BTC');
            const lowBalanceAlert = alerts.find(a => a.alertType === 'LOW_BALANCE');
            expect(lowBalanceAlert).toBeUndefined();
        });
        it('should get balance alerts for currency', () => {
            balanceManager.setBalanceAlert('BTC', 'LOW_BALANCE', 0.1);
            balanceManager.setBalanceAlert('BTC', 'HIGH_BALANCE', 10.0);
            const alerts = balanceManager.getBalanceAlerts('BTC');
            expect(alerts).toHaveLength(2);
            expect(alerts.map(a => a.alertType)).toContain('LOW_BALANCE');
            expect(alerts.map(a => a.alertType)).toContain('HIGH_BALANCE');
        });
        it('should return empty array for currency with no alerts', () => {
            const alerts = balanceManager.getBalanceAlerts('DOGE');
            expect(alerts).toHaveLength(0);
        });
    });
    describe('Emergency Stop', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should not trigger emergency stop with no historical data', async () => {
            const result = await balanceManager.checkEmergencyStop();
            expect(result).toBe(false);
        });
        it('should trigger emergency stop on significant loss', async () => {
            // Create historical snapshot with higher value
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '60000' }]) // Higher BTC price for snapshot
                .mockResolvedValueOnce([{ last: '4000' }]); // Higher ETH price for snapshot
            await balanceManager.createBalanceSnapshot();
            // Mock current lower prices (simulating loss)
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '40000' }]) // Lower BTC price
                .mockResolvedValueOnce([{ last: '2000' }]); // Lower ETH price
            const emergencyStopSpy = jest.fn();
            balanceManager.on('emergencyStop', emergencyStopSpy);
            const result = await balanceManager.checkEmergencyStop();
            // This test might not trigger due to timing constraints in test environment
            // In a real scenario, you'd need to manipulate the snapshot timestamp
            expect(typeof result).toBe('boolean');
        });
    });
    describe('Statistics and Configuration', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should return balance statistics', () => {
            const stats = balanceManager.getBalanceStats();
            expect(stats).toHaveProperty('totalBalanceChecks');
            expect(stats).toHaveProperty('discrepanciesDetected');
            expect(stats).toHaveProperty('alertsTriggered');
            expect(stats).toHaveProperty('balanceAccuracy');
            expect(stats.totalBalanceChecks).toBeGreaterThan(0);
        });
        it('should return current configuration', () => {
            const config = balanceManager.getConfig();
            expect(config).toHaveProperty('enableRealTimeMonitoring');
            expect(config).toHaveProperty('monitoringInterval');
            expect(config).toHaveProperty('discrepancyThreshold');
            expect(config).toHaveProperty('enableAlerts');
        });
        it('should update configuration', () => {
            const newConfig = {
                monitoringInterval: 60000,
                enableAlerts: false,
            };
            balanceManager.updateConfig(newConfig);
            const config = balanceManager.getConfig();
            expect(config.monitoringInterval).toBe(60000);
            expect(config.enableAlerts).toBe(false);
        });
    });
    describe('Error Handling', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should handle API errors in balance retrieval', async () => {
            mockGateIOClient.makeRequest.mockRejectedValue(new Error('API error'));
            await expect(balanceManager.getCurrentBalances(true)).rejects.toThrow('API error');
        });
        it('should handle API errors in validation', async () => {
            mockGateIOClient.makeRequest.mockRejectedValue(new Error('Validation API error'));
            await expect(balanceManager.validateBalances()).rejects.toThrow('Validation API error');
        });
        it('should handle API errors in reconciliation', async () => {
            mockGateIOClient.makeRequest.mockRejectedValue(new Error('Reconciliation API error'));
            await expect(balanceManager.reconcileTransactions()).rejects.toThrow('Reconciliation API error');
        });
        it('should handle missing balance data gracefully', async () => {
            const balance = await balanceManager.getBalance('NONEXISTENT');
            expect(balance).toBeNull();
        });
    });
    describe('Event Emission', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should emit balance alert events', async () => {
            const alertSpy = jest.fn();
            balanceManager.on('balanceAlert', alertSpy);
            // Set a low balance alert that should trigger
            balanceManager.setBalanceAlert('BTC', 'LOW_BALANCE', 10.0); // Higher than current balance
            // This would require triggering the alert check mechanism
            // In a real scenario, this would be triggered by the monitoring interval
        });
        it('should emit emergency stop events', async () => {
            const emergencyStopSpy = jest.fn();
            balanceManager.on('emergencyStop', emergencyStopSpy);
            // This would require setting up conditions for emergency stop
            // and triggering the check mechanism
        });
    });
    describe('Shutdown', () => {
        beforeEach(async () => {
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize();
        });
        it('should shutdown gracefully', async () => {
            // Mock snapshot creation during shutdown
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce([{ last: '50000' }])
                .mockResolvedValueOnce([{ last: '3000' }]);
            await balanceManager.shutdown();
            expect(mockAuditService.logSecurityEvent).toHaveBeenCalledWith(expect.objectContaining({
                type: 'BALANCE_MANAGER_SHUTDOWN',
                severity: 'INFO'
            }));
        });
    });
    describe('Real-time Monitoring', () => {
        it('should start monitoring when enabled in config', async () => {
            const config = { enableRealTimeMonitoring: true, monitoringInterval: 1000 };
            mockGateIOClient.makeRequest
                .mockResolvedValue(sampleSpotAccounts)
                .mockResolvedValue(sampleTradeHistory);
            await balanceManager.initialize(config);
            // Monitoring would be started automatically
            // In a real test, you might want to verify timer creation
            expect(mockGateIOClient.makeRequest).toHaveBeenCalled();
        });
        it('should not start monitoring when disabled in config', async () => {
            const config = { enableRealTimeMonitoring: false };
            mockGateIOClient.makeRequest
                .mockResolvedValueOnce(sampleSpotAccounts)
                .mockResolvedValueOnce(sampleTradeHistory);
            await balanceManager.initialize(config);
            // Should only be called during initialization, not for monitoring
            expect(mockGateIOClient.makeRequest).toHaveBeenCalledTimes(2);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxOaWNrXFxEZXNrdG9wXFxTbW9vdGhTYWlsXFxzcmNcXHRyYWRpbmdcXGFjY291bnRcXF9fdGVzdHNfX1xcYmFsYW5jZS1tYW5hZ2VyLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7R0FZRzs7QUFPSCxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQztBQUN0QyxJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFSbkMsd0RBQW9EO0FBQ3BELDZEQUF3RDtBQUN4RCw0REFBd0Q7QUFReEQsTUFBTSxrQkFBa0IsR0FBRyw2QkFBcUQsQ0FBQztBQUNqRixNQUFNLGtCQUFrQixHQUFHLDRCQUFxRCxDQUFDO0FBRWpGLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDOUIsSUFBSSxjQUE4QixDQUFDO0lBQ25DLElBQUksZ0JBQTJDLENBQUM7SUFDaEQsSUFBSSxnQkFBMkMsQ0FBQztJQUVoRCxjQUFjO0lBQ2QsTUFBTSxrQkFBa0IsR0FBa0I7UUFDeEM7WUFDRSxRQUFRLEVBQUUsS0FBSztZQUNmLFNBQVMsRUFBRSxLQUFLO1lBQ2hCLE1BQU0sRUFBRSxLQUFLO1NBQ2Q7UUFDRDtZQUNFLFFBQVEsRUFBRSxLQUFLO1lBQ2YsU0FBUyxFQUFFLEtBQUs7WUFDaEIsTUFBTSxFQUFFLEtBQUs7U0FDZDtRQUNEO1lBQ0UsUUFBUSxFQUFFLE1BQU07WUFDaEIsU0FBUyxFQUFFLFFBQVE7WUFDbkIsTUFBTSxFQUFFLE9BQU87U0FDaEI7S0FDRixDQUFDO0lBRUYsTUFBTSxrQkFBa0IsR0FBbUI7UUFDekM7WUFDRSxFQUFFLEVBQUUsU0FBUztZQUNiLFdBQVcsRUFBRSxzQkFBc0I7WUFDbkMsY0FBYyxFQUFFLGVBQWU7WUFDL0IsYUFBYSxFQUFFLFVBQVU7WUFDekIsSUFBSSxFQUFFLEtBQUs7WUFDWCxJQUFJLEVBQUUsT0FBTztZQUNiLE1BQU0sRUFBRSxLQUFLO1lBQ2IsS0FBSyxFQUFFLE9BQU87WUFDZCxRQUFRLEVBQUUsU0FBUztZQUNuQixHQUFHLEVBQUUsT0FBTztZQUNaLFlBQVksRUFBRSxLQUFLO1lBQ25CLFNBQVMsRUFBRSxHQUFHO1lBQ2QsTUFBTSxFQUFFLEdBQUc7U0FDWjtLQUNGLENBQUM7SUFFRixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLHFCQUFxQjtRQUNyQixnQkFBZ0IsR0FBRyxJQUFJLGtCQUFrQixFQUErQixDQUFDO1FBQ3pFLGdCQUFnQixDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFFekMscUJBQXFCO1FBQ3JCLGdCQUFnQixHQUFHLElBQUksa0JBQWtCLEVBQStCLENBQUM7UUFDekUsZ0JBQWdCLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRTNFLGtDQUFrQztRQUNsQyxjQUFjLEdBQUcsSUFBSSxnQ0FBYyxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDeEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsQ0FBQywyREFBMkQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN6RSxnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLGdCQUFnQjtpQkFDMUQscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLHFCQUFxQjtZQUVuRSxNQUFNLE1BQU0sR0FBRyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUVqRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLG9CQUFvQixDQUM1RCxNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLElBQUksRUFBRSw2QkFBNkI7Z0JBQ25DLFFBQVEsRUFBRSxNQUFNO2FBQ2pCLENBQUMsQ0FDSCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0QsZ0JBQWdCLENBQUMsV0FBVztpQkFDekIscUJBQXFCLENBQUMsa0JBQWtCLENBQUM7aUJBQ3pDLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFN0MsTUFBTSxZQUFZLEdBQUc7Z0JBQ25CLGtCQUFrQixFQUFFLEtBQUs7Z0JBQ3pCLFlBQVksRUFBRSxLQUFLO2FBQ3BCLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLGNBQWMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxQixNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDMUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMxQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMvRCxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztZQUV2RSxNQUFNLE1BQU0sR0FBRyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUVqRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLG9CQUFvQixDQUM1RCxNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLElBQUksRUFBRSw2QkFBNkI7Z0JBQ25DLFFBQVEsRUFBRSxPQUFPO2FBQ2xCLENBQUMsQ0FDSCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDakMsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ3BCLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDO2lCQUN6QyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNDLE1BQU0sUUFBUSxHQUFHLE1BQU0sY0FBYyxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFM0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFeEMsTUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCxNQUFNLFVBQVUsR0FBRyxNQUFNLGNBQWMsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFMUQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVELE1BQU0sT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUV4RCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0JBQStCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0MsTUFBTSxlQUFlLEdBQUc7Z0JBQ3RCLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUU7YUFDckQsQ0FBQztZQUVGLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUVwRSxNQUFNLFFBQVEsR0FBRyxNQUFNLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUUvRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLENBQUMsb0JBQW9CLENBQ3ZELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztnQkFDdEIsTUFBTSxFQUFFLEtBQUs7Z0JBQ2IsR0FBRyxFQUFFLGdCQUFnQjthQUN0QixDQUFDLENBQ0gsQ0FBQztZQUVGLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7UUFDM0MsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ3BCLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDO2lCQUN6QyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RELHNCQUFzQjtZQUN0QixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQyxZQUFZO2lCQUN2RCxxQkFBcUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVk7WUFFMUQsTUFBTSxVQUFVLEdBQUcsTUFBTSxjQUFjLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztZQUVqRSwyQkFBMkI7WUFDM0IseUJBQXlCO1lBQ3pCLHdCQUF3QjtZQUN4QixlQUFlO1lBQ2YsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMzRCxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDO1lBRTdFLE1BQU0sVUFBVSxHQUFHLE1BQU0sY0FBYyxDQUFDLHNCQUFzQixFQUFFLENBQUM7WUFFakUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtRQUM1RCxVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDcEIsZ0JBQWdCLENBQUMsV0FBVztpQkFDekIscUJBQXFCLENBQUMsa0JBQWtCLENBQUM7aUJBQ3pDLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDN0MsTUFBTSxjQUFjLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFdkUsTUFBTSxhQUFhLEdBQUcsTUFBTSxjQUFjLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUU5RCxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hFLE1BQU0sZ0JBQWdCLEdBQUc7Z0JBQ3ZCLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBRSx3QkFBd0I7Z0JBQzlFLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUU7Z0JBQ3BELEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUU7YUFDM0QsQ0FBQztZQUVGLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRXJFLE1BQU0sYUFBYSxHQUFHLE1BQU0sY0FBYyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFFOUQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEQsTUFBTSxjQUFjLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLEtBQUssS0FBSyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxjQUFjLEVBQUUsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxjQUFjLEVBQUUsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pELE1BQU0sZ0JBQWdCLEdBQUc7Z0JBQ3ZCLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUU7YUFDckQsQ0FBQztZQUVGLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRXJFLE1BQU0sYUFBYSxHQUFHLE1BQU0sY0FBYyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRW5FLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDOUQsTUFBTSxnQkFBZ0IsR0FBRztnQkFDdkIsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFLHdCQUF3QjthQUMvRSxDQUFDO1lBRUYsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLHFCQUFxQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFFckUsTUFBTSxhQUFhLEdBQUcsTUFBTSxjQUFjLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFbkUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7UUFDMUMsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ3BCLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDO2lCQUN6QyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzFELE1BQU0sT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFN0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUNyRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELE1BQU0sT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDLHFCQUFxQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWxFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseUNBQXlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdkQscUVBQXFFO1lBQ3JFLE1BQU0sT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFN0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUNwQixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDekMscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM5QyxtQ0FBbUM7WUFDbkMsZ0JBQWdCLENBQUMsV0FBVztpQkFDekIscUJBQXFCLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsWUFBWTtpQkFDdkQscUJBQXFCLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZO1lBRTFELE1BQU0sUUFBUSxHQUFHLE1BQU0sY0FBYyxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFOUQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0JBQStCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0MsMEJBQTBCO1lBQzFCLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztpQkFDMUMscUJBQXFCLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFFN0MsTUFBTSxjQUFjLENBQUMscUJBQXFCLEVBQUUsQ0FBQztZQUU3QyxNQUFNLE9BQU8sR0FBRyxjQUFjLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUVuRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO1lBQzlDLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVwRCxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUNwQixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDekMscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7WUFDbEMsTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsYUFBYSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFMUIsTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRXpDLE1BQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLGFBQWEsQ0FBQyxDQUFDO1lBQ3hFLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUN0QyxNQUFNLENBQUMsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsYUFBYSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBRTFELE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsYUFBYSxDQUFDLENBQUM7WUFFdkUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUUxQixNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdEQsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLEtBQUssYUFBYSxDQUFDLENBQUM7WUFDeEUsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxjQUFjLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxhQUFhLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDMUQsY0FBYyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRTVELE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV0RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVEQUF1RCxFQUFFLEdBQUcsRUFBRTtZQUMvRCxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFdkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDcEIsZ0JBQWdCLENBQUMsV0FBVztpQkFDekIscUJBQXFCLENBQUMsa0JBQWtCLENBQUM7aUJBQ3pDLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDN0MsTUFBTSxjQUFjLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkRBQTJELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDekUsTUFBTSxNQUFNLEdBQUcsTUFBTSxjQUFjLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUV6RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pFLCtDQUErQztZQUMvQyxnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQyxnQ0FBZ0M7aUJBQzNFLHFCQUFxQixDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0NBQWdDO1lBRTlFLE1BQU0sY0FBYyxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFN0MsOENBQThDO1lBQzlDLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDLGtCQUFrQjtpQkFDN0QscUJBQXFCLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBa0I7WUFFaEUsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDbkMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztZQUVyRCxNQUFNLE1BQU0sR0FBRyxNQUFNLGNBQWMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRXpELDRFQUE0RTtZQUM1RSxzRUFBc0U7WUFDdEUsTUFBTSxDQUFDLE9BQU8sTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO1FBQzVDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUNwQixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDekMscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7WUFDMUMsTUFBTSxLQUFLLEdBQUcsY0FBYyxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBRS9DLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUM3QyxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsU0FBUyxFQUFFLENBQUM7WUFFMUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1lBQzFELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLHNCQUFzQixDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxTQUFTLEdBQUc7Z0JBQ2hCLGtCQUFrQixFQUFFLEtBQUs7Z0JBQ3pCLFlBQVksRUFBRSxLQUFLO2FBQ3BCLENBQUM7WUFFRixjQUFjLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXZDLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUMxQyxNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUNwQixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDekMscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RCxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztZQUV2RSxNQUFNLE1BQU0sQ0FBQyxjQUFjLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3JGLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RELGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUM7WUFFbEYsTUFBTSxNQUFNLENBQUMsY0FBYyxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDMUYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUQsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQztZQUV0RixNQUFNLE1BQU0sQ0FBQyxjQUFjLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQztRQUNuRyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RCxNQUFNLE9BQU8sR0FBRyxNQUFNLGNBQWMsQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLENBQUM7WUFFL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUNwQixnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQztpQkFDekMscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUM3QyxNQUFNLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDM0IsY0FBYyxDQUFDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFNUMsOENBQThDO1lBQzlDLGNBQWMsQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLDhCQUE4QjtZQUUxRiwwREFBMEQ7WUFDMUQseUVBQXlFO1FBQzNFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ25DLGNBQWMsQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLGdCQUFnQixDQUFDLENBQUM7WUFFckQsOERBQThEO1lBQzlELHFDQUFxQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7UUFDeEIsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ3BCLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDO2lCQUN6QyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRCQUE0QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzFDLHlDQUF5QztZQUN6QyxnQkFBZ0IsQ0FBQyxXQUFXO2lCQUN6QixxQkFBcUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7aUJBQzFDLHFCQUFxQixDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRTdDLE1BQU0sY0FBYyxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBRWhDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLG9CQUFvQixDQUM1RCxNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLElBQUksRUFBRSwwQkFBMEI7Z0JBQ2hDLFFBQVEsRUFBRSxNQUFNO2FBQ2pCLENBQUMsQ0FDSCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDcEMsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlELE1BQU0sTUFBTSxHQUFHLEVBQUUsd0JBQXdCLEVBQUUsSUFBSSxFQUFFLGtCQUFrQixFQUFFLElBQUksRUFBRSxDQUFDO1lBRTVFLGdCQUFnQixDQUFDLFdBQVc7aUJBQ3pCLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDO2lCQUNyQyxpQkFBaUIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBRXpDLE1BQU0sY0FBYyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUV4Qyw0Q0FBNEM7WUFDNUMsMERBQTBEO1lBQzFELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFEQUFxRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ25FLE1BQU0sTUFBTSxHQUFHLEVBQUUsd0JBQXdCLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFFbkQsZ0JBQWdCLENBQUMsV0FBVztpQkFDekIscUJBQXFCLENBQUMsa0JBQWtCLENBQUM7aUJBQ3pDLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFFN0MsTUFBTSxjQUFjLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXhDLGtFQUFrRTtZQUNsRSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcTmlja1xcRGVza3RvcFxcU21vb3RoU2FpbFxcc3JjXFx0cmFkaW5nXFxhY2NvdW50XFxfX3Rlc3RzX19cXGJhbGFuY2UtbWFuYWdlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBCQUxBTkNFIE1BTkFHRVIgVEVTVFNcclxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogXHJcbiAqIENvbXByZWhlbnNpdmUgdGVzdCBzdWl0ZSBmb3IgdGhlIGJhbGFuY2UgbWFuYWdlbWVudCBzeXN0ZW0gd2l0aCByZWFsLXRpbWVcclxuICogbW9uaXRvcmluZywgdmFsaWRhdGlvbiwgZGlzY3JlcGFuY3kgZGV0ZWN0aW9uLCBhbmQgcmVjb25jaWxpYXRpb24uXHJcbiAqIFxyXG4gKiBAYXV0aG9yIEFJIENyeXB0byBUcmFkaW5nIFN5c3RlbVxyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKiBAbGljZW5zZSBQUk9QUklFVEFSWVxyXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEJhbGFuY2VNYW5hZ2VyIH0gZnJvbSAnLi4vYmFsYW5jZS1tYW5hZ2VyJztcclxuaW1wb3J0IHsgR2F0ZUlPQ2xpZW50IH0gZnJvbSAnLi4vLi4vYXBpL2dhdGUtaW8tY2xpZW50JztcclxuaW1wb3J0IHsgQXVkaXRTZXJ2aWNlIH0gZnJvbSAnQC9zZWN1cml0eS9hdWRpdC1zZXJ2aWNlJztcclxuaW1wb3J0IHsgQWNjb3VudEJhbGFuY2UsIFNwb3RBY2NvdW50LCBUcmFkZUhpc3RvcnkgfSBmcm9tICcuLi8uLi9hcGkvdHlwZXMnO1xyXG5cclxuLy8gTW9jayBkZXBlbmRlbmNpZXNcclxuamVzdC5tb2NrKCcuLi8uLi9hcGkvZ2F0ZS1pby1jbGllbnQnKTtcclxuamVzdC5tb2NrKCdAL3NlY3VyaXR5L2F1ZGl0LXNlcnZpY2UnKTtcclxuamVzdC5tb2NrKCdAL2NvcmUvbG9nZ2luZy9sb2dnZXInKTtcclxuXHJcbmNvbnN0IE1vY2tlZEdhdGVJT0NsaWVudCA9IEdhdGVJT0NsaWVudCBhcyBqZXN0Lk1vY2tlZENsYXNzPHR5cGVvZiBHYXRlSU9DbGllbnQ+O1xyXG5jb25zdCBNb2NrZWRBdWRpdFNlcnZpY2UgPSBBdWRpdFNlcnZpY2UgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgQXVkaXRTZXJ2aWNlPjtcclxuXHJcbmRlc2NyaWJlKCdCYWxhbmNlTWFuYWdlcicsICgpID0+IHtcclxuICBsZXQgYmFsYW5jZU1hbmFnZXI6IEJhbGFuY2VNYW5hZ2VyO1xyXG4gIGxldCBtb2NrR2F0ZUlPQ2xpZW50OiBqZXN0Lk1vY2tlZDxHYXRlSU9DbGllbnQ+O1xyXG4gIGxldCBtb2NrQXVkaXRTZXJ2aWNlOiBqZXN0Lk1vY2tlZDxBdWRpdFNlcnZpY2U+O1xyXG5cclxuICAvLyBTYW1wbGUgZGF0YVxyXG4gIGNvbnN0IHNhbXBsZVNwb3RBY2NvdW50czogU3BvdEFjY291bnRbXSA9IFtcclxuICAgIHtcclxuICAgICAgY3VycmVuY3k6ICdCVEMnLFxyXG4gICAgICBhdmFpbGFibGU6ICcwLjUnLFxyXG4gICAgICBsb2NrZWQ6ICcwLjEnLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgY3VycmVuY3k6ICdFVEgnLFxyXG4gICAgICBhdmFpbGFibGU6ICcyLjAnLFxyXG4gICAgICBsb2NrZWQ6ICcwLjUnLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgY3VycmVuY3k6ICdVU0RUJyxcclxuICAgICAgYXZhaWxhYmxlOiAnMTAwMC4wJyxcclxuICAgICAgbG9ja2VkOiAnMjAwLjAnLFxyXG4gICAgfSxcclxuICBdO1xyXG5cclxuICBjb25zdCBzYW1wbGVUcmFkZUhpc3Rvcnk6IFRyYWRlSGlzdG9yeVtdID0gW1xyXG4gICAge1xyXG4gICAgICBpZDogJ3RyYWRlLTEnLFxyXG4gICAgICBjcmVhdGVfdGltZTogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJyxcclxuICAgICAgY3JlYXRlX3RpbWVfbXM6ICcxNzA0MDY3MjAwMDAwJyxcclxuICAgICAgY3VycmVuY3lfcGFpcjogJ0JUQ19VU0RUJyxcclxuICAgICAgc2lkZTogJ2J1eScsXHJcbiAgICAgIHJvbGU6ICd0YWtlcicsXHJcbiAgICAgIGFtb3VudDogJzAuMScsXHJcbiAgICAgIHByaWNlOiAnNTAwMDAnLFxyXG4gICAgICBvcmRlcl9pZDogJ29yZGVyLTEnLFxyXG4gICAgICBmZWU6ICcwLjAwMScsXHJcbiAgICAgIGZlZV9jdXJyZW5jeTogJ0JUQycsXHJcbiAgICAgIHBvaW50X2ZlZTogJzAnLFxyXG4gICAgICBndF9mZWU6ICcwJyxcclxuICAgIH0sXHJcbiAgXTtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIFxyXG4gICAgLy8gTW9jayBHYXRlSU8gY2xpZW50XHJcbiAgICBtb2NrR2F0ZUlPQ2xpZW50ID0gbmV3IE1vY2tlZEdhdGVJT0NsaWVudCgpIGFzIGplc3QuTW9ja2VkPEdhdGVJT0NsaWVudD47XHJcbiAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0ID0gamVzdC5mbigpO1xyXG4gICAgXHJcbiAgICAvLyBNb2NrIGF1ZGl0IHNlcnZpY2VcclxuICAgIG1vY2tBdWRpdFNlcnZpY2UgPSBuZXcgTW9ja2VkQXVkaXRTZXJ2aWNlKCkgYXMgamVzdC5Nb2NrZWQ8QXVkaXRTZXJ2aWNlPjtcclxuICAgIG1vY2tBdWRpdFNlcnZpY2UubG9nU2VjdXJpdHlFdmVudCA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgYmFsYW5jZSBtYW5hZ2VyIGluc3RhbmNlXHJcbiAgICBiYWxhbmNlTWFuYWdlciA9IG5ldyBCYWxhbmNlTWFuYWdlcihtb2NrR2F0ZUlPQ2xpZW50KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0luaXRpYWxpemF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHN1Y2Nlc3NmdWxseSB3aXRoIGRlZmF1bHQgY29uZmlndXJhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdFxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlU3BvdEFjY291bnRzKSAvLyBMb2FkIGJhbGFuY2VzXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpOyAvLyBMb2FkIHRyYWRlIGhpc3RvcnlcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLmluaXRpYWxpemUoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChtb2NrQXVkaXRTZXJ2aWNlLmxvZ1NlY3VyaXR5RXZlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgIHR5cGU6ICdCQUxBTkNFX01BTkFHRVJfSU5JVElBTElaRUQnLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICdJTkZPJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBjdXN0b20gY29uZmlndXJhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdFxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlU3BvdEFjY291bnRzKVxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlVHJhZGVIaXN0b3J5KTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGN1c3RvbUNvbmZpZyA9IHtcclxuICAgICAgICBtb25pdG9yaW5nSW50ZXJ2YWw6IDYwMDAwLFxyXG4gICAgICAgIGVuYWJsZUFsZXJ0czogZmFsc2UsXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKGN1c3RvbUNvbmZpZyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xyXG4gICAgICBjb25zdCBjb25maWcgPSBiYWxhbmNlTWFuYWdlci5nZXRDb25maWcoKTtcclxuICAgICAgZXhwZWN0KGNvbmZpZy5tb25pdG9yaW5nSW50ZXJ2YWwpLnRvQmUoNjAwMDApO1xyXG4gICAgICBleHBlY3QoY29uZmlnLmVuYWJsZUFsZXJ0cykudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbml0aWFsaXphdGlvbiBmYWlsdXJlIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3QubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdBUEkgZXJyb3InKSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcclxuICAgICAgZXhwZWN0KG1vY2tBdWRpdFNlcnZpY2UubG9nU2VjdXJpdHlFdmVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgdHlwZTogJ0JBTEFOQ0VfTUFOQUdFUl9JTklUX0ZBSUxFRCcsXHJcbiAgICAgICAgICBzZXZlcml0eTogJ0VSUk9SJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0JhbGFuY2UgUmV0cmlldmFsJywgKCkgPT4ge1xyXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNhbXBsZVNwb3RBY2NvdW50cylcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNhbXBsZVRyYWRlSGlzdG9yeSk7XHJcbiAgICAgIGF3YWl0IGJhbGFuY2VNYW5hZ2VyLmluaXRpYWxpemUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2V0IGN1cnJlbnQgYmFsYW5jZXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJhbGFuY2VzID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIuZ2V0Q3VycmVudEJhbGFuY2VzKCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoYmFsYW5jZXMuc2l6ZSkudG9CZSgzKTtcclxuICAgICAgZXhwZWN0KGJhbGFuY2VzLmhhcygnQlRDJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChiYWxhbmNlcy5oYXMoJ0VUSCcpKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QoYmFsYW5jZXMuaGFzKCdVU0RUJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBidGNCYWxhbmNlID0gYmFsYW5jZXMuZ2V0KCdCVEMnKTtcclxuICAgICAgZXhwZWN0KGJ0Y0JhbGFuY2U/LmF2YWlsYWJsZSkudG9CZSgnMC41Jyk7XHJcbiAgICAgIGV4cGVjdChidGNCYWxhbmNlPy5sb2NrZWQpLnRvQmUoJzAuMScpO1xyXG4gICAgICBleHBlY3QoYnRjQmFsYW5jZT8udG90YWwpLnRvQmUoJzAuNicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBnZXQgYmFsYW5jZSBmb3Igc3BlY2lmaWMgY3VycmVuY3knLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJ0Y0JhbGFuY2UgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5nZXRCYWxhbmNlKCdCVEMnKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChidGNCYWxhbmNlKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoYnRjQmFsYW5jZT8uY3VycmVuY3kpLnRvQmUoJ0JUQycpO1xyXG4gICAgICBleHBlY3QoYnRjQmFsYW5jZT8udG90YWwpLnRvQmUoJzAuNicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCBmb3Igbm9uLWV4aXN0ZW50IGN1cnJlbmN5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIuZ2V0QmFsYW5jZSgnRE9HRScpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvQmVOdWxsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGZvcmNlIHJlZnJlc2ggYmFsYW5jZXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRBY2NvdW50cyA9IFtcclxuICAgICAgICB7IGN1cnJlbmN5OiAnQlRDJywgYXZhaWxhYmxlOiAnMC43JywgbG9ja2VkOiAnMC4xJyB9LFxyXG4gICAgICBdO1xyXG4gICAgICBcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UodXBkYXRlZEFjY291bnRzKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGJhbGFuY2VzID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIuZ2V0Q3VycmVudEJhbGFuY2VzKHRydWUpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICB1cmw6ICcvc3BvdC9hY2NvdW50cydcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgYnRjQmFsYW5jZSA9IGJhbGFuY2VzLmdldCgnQlRDJyk7XHJcbiAgICAgIGV4cGVjdChidGNCYWxhbmNlPy50b3RhbCkudG9CZSgnMC44Jyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1BvcnRmb2xpbyBWYWx1ZSBDYWxjdWxhdGlvbicsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB0b3RhbCBwb3J0Zm9saW8gdmFsdWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIE1vY2sgcHJpY2UgcmVxdWVzdHNcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdFxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgbGFzdDogJzUwMDAwJyB9XSkgLy8gQlRDIHByaWNlXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBsYXN0OiAnMzAwMCcgfV0pOyAvLyBFVEggcHJpY2VcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRvdGFsVmFsdWUgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5nZXRUb3RhbFBvcnRmb2xpb1ZhbHVlKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBCVEM6IDAuNiAqIDUwMDAwID0gMzAwMDBcclxuICAgICAgLy8gRVRIOiAyLjUgKiAzMDAwID0gNzUwMFxyXG4gICAgICAvLyBVU0RUOiAxMjAwICogMSA9IDEyMDBcclxuICAgICAgLy8gVG90YWw6IDM4NzAwXHJcbiAgICAgIGV4cGVjdCh0b3RhbFZhbHVlKS50b0JlKDM4NzAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHByaWNlIGZldGNoIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0Lm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUHJpY2UgQVBJIGVycm9yJykpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgdG90YWxWYWx1ZSA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLmdldFRvdGFsUG9ydGZvbGlvVmFsdWUoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdCh0b3RhbFZhbHVlKS50b0JlKDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdCYWxhbmNlIFZhbGlkYXRpb24gYW5kIERpc2NyZXBhbmN5IERldGVjdGlvbicsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBubyBkaXNjcmVwYW5jaWVzIHdoZW4gYmFsYW5jZXMgbWF0Y2gnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNhbXBsZVNwb3RBY2NvdW50cyk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkaXNjcmVwYW5jaWVzID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIudmFsaWRhdGVCYWxhbmNlcygpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGRpc2NyZXBhbmNpZXMpLnRvSGF2ZUxlbmd0aCgwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGRpc2NyZXBhbmNpZXMgd2hlbiBiYWxhbmNlcyBkaWZmZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vZGlmaWVkQWNjb3VudHMgPSBbXHJcbiAgICAgICAgeyBjdXJyZW5jeTogJ0JUQycsIGF2YWlsYWJsZTogJzAuNCcsIGxvY2tlZDogJzAuMScgfSwgLy8gRGlmZmVyZW50IGZyb20gY2FjaGVkXHJcbiAgICAgICAgeyBjdXJyZW5jeTogJ0VUSCcsIGF2YWlsYWJsZTogJzIuMCcsIGxvY2tlZDogJzAuNScgfSxcclxuICAgICAgICB7IGN1cnJlbmN5OiAnVVNEVCcsIGF2YWlsYWJsZTogJzEwMDAuMCcsIGxvY2tlZDogJzIwMC4wJyB9LFxyXG4gICAgICBdO1xyXG4gICAgICBcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9kaWZpZWRBY2NvdW50cyk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkaXNjcmVwYW5jaWVzID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIudmFsaWRhdGVCYWxhbmNlcygpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGRpc2NyZXBhbmNpZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGNvbnN0IGJ0Y0Rpc2NyZXBhbmN5ID0gZGlzY3JlcGFuY2llcy5maW5kKGQgPT4gZC5jdXJyZW5jeSA9PT0gJ0JUQycpO1xyXG4gICAgICBleHBlY3QoYnRjRGlzY3JlcGFuY3kpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChidGNEaXNjcmVwYW5jeT8uaGFzRGlzY3JlcGFuY3kpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChidGNEaXNjcmVwYW5jeT8uZXhwZWN0ZWRCYWxhbmNlKS50b0JlKDAuNik7XHJcbiAgICAgIGV4cGVjdChidGNEaXNjcmVwYW5jeT8uYWN0dWFsQmFsYW5jZSkudG9CZSgwLjUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzcGVjaWZpYyBjdXJyZW5jeScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbW9kaWZpZWRBY2NvdW50cyA9IFtcclxuICAgICAgICB7IGN1cnJlbmN5OiAnQlRDJywgYXZhaWxhYmxlOiAnMC40JywgbG9ja2VkOiAnMC4xJyB9LFxyXG4gICAgICBdO1xyXG4gICAgICBcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9kaWZpZWRBY2NvdW50cyk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkaXNjcmVwYW5jaWVzID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIudmFsaWRhdGVCYWxhbmNlcygnQlRDJyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoZGlzY3JlcGFuY2llcykudG9IYXZlTGVuZ3RoKDEpO1xyXG4gICAgICBleHBlY3QoZGlzY3JlcGFuY2llc1swXS5jdXJyZW5jeSkudG9CZSgnQlRDJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNsYXNzaWZ5IGRpc2NyZXBhbmN5IHNldmVyaXR5IGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbW9kaWZpZWRBY2NvdW50cyA9IFtcclxuICAgICAgICB7IGN1cnJlbmN5OiAnQlRDJywgYXZhaWxhYmxlOiAnMC4xJywgbG9ja2VkOiAnMC4xJyB9LCAvLyA2NiUgZGlmZmVyZW5jZSAtIEhJR0hcclxuICAgICAgXTtcclxuICAgICAgXHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vZGlmaWVkQWNjb3VudHMpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGlzY3JlcGFuY2llcyA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLnZhbGlkYXRlQmFsYW5jZXMoJ0JUQycpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGRpc2NyZXBhbmNpZXNbMF0uc2V2ZXJpdHkpLnRvQmUoJ0hJR0gnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnVHJhbnNhY3Rpb24gUmVjb25jaWxpYXRpb24nLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdFxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlU3BvdEFjY291bnRzKVxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlVHJhZGVIaXN0b3J5KTtcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWNvbmNpbGUgdHJhbnNhY3Rpb25zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLnJlY29uY2lsZVRyYW5zYWN0aW9ucygpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdKS50b0hhdmVQcm9wZXJ0eSgnaXNSZWNvbmNpbGVkJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdKS50b0hhdmVQcm9wZXJ0eSgnY3VycmVuY3knKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0pLnRvSGF2ZVByb3BlcnR5KCdleHBlY3RlZEJhbGFuY2UnKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0pLnRvSGF2ZVByb3BlcnR5KCdhY3R1YWxCYWxhbmNlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJlY29uY2lsZSBzcGVjaWZpYyBjdXJyZW5jeScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLnJlY29uY2lsZVRyYW5zYWN0aW9ucygnQlRDJyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDEpO1xyXG4gICAgICBleHBlY3QocmVzdWx0c1swXS5jdXJyZW5jeSkudG9CZSgnQlRDJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGRldGVjdCB1bnJlY29uY2lsZWQgdHJhbnNhY3Rpb25zJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBUaGlzIHdvdWxkIHJlcXVpcmUgbW9yZSBjb21wbGV4IHNldHVwIHdpdGggbWlzbWF0Y2hlZCB0cmFuc2FjdGlvbnNcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGJhbGFuY2VNYW5hZ2VyLnJlY29uY2lsZVRyYW5zYWN0aW9ucygpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0pLnRvSGF2ZVByb3BlcnR5KCd1bnJlY29uY2lsZWRUcmFuc2FjdGlvbnMnKTtcclxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0c1swXS51bnJlY29uY2lsZWRUcmFuc2FjdGlvbnMpKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdCYWxhbmNlIFNuYXBzaG90cycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBiYWxhbmNlIHNuYXBzaG90JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBNb2NrIHBvcnRmb2xpbyB2YWx1ZSBjYWxjdWxhdGlvblxyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBsYXN0OiAnNTAwMDAnIH1dKSAvLyBCVEMgcHJpY2VcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGxhc3Q6ICczMDAwJyB9XSk7IC8vIEVUSCBwcmljZVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5jcmVhdGVCYWxhbmNlU25hcHNob3QoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChzbmFwc2hvdCkudG9IYXZlUHJvcGVydHkoJ3NuYXBzaG90SWQnKTtcclxuICAgICAgZXhwZWN0KHNuYXBzaG90KS50b0hhdmVQcm9wZXJ0eSgndGltZXN0YW1wJyk7XHJcbiAgICAgIGV4cGVjdChzbmFwc2hvdCkudG9IYXZlUHJvcGVydHkoJ2JhbGFuY2VzJyk7XHJcbiAgICAgIGV4cGVjdChzbmFwc2hvdCkudG9IYXZlUHJvcGVydHkoJ3RvdGFsVmFsdWVVU0QnKTtcclxuICAgICAgZXhwZWN0KHNuYXBzaG90LmJhbGFuY2VzLnNpemUpLnRvQmUoMyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBiYWxhbmNlIGhpc3RvcnknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIENyZWF0ZSBhIHNuYXBzaG90IGZpcnN0XHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGxhc3Q6ICc1MDAwMCcgfV0pXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBsYXN0OiAnMzAwMCcgfV0pO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuY3JlYXRlQmFsYW5jZVNuYXBzaG90KCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBoaXN0b3J5ID0gYmFsYW5jZU1hbmFnZXIuZ2V0QmFsYW5jZUhpc3RvcnkoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChoaXN0b3J5Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QoaGlzdG9yeVswXSkudG9IYXZlUHJvcGVydHkoJ3NuYXBzaG90SWQnKTtcclxuICAgICAgZXhwZWN0KGhpc3RvcnlbMF0pLnRvSGF2ZVByb3BlcnR5KCd0aW1lc3RhbXAnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbGltaXQgYmFsYW5jZSBoaXN0b3J5IHJlc3VsdHMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGhpc3RvcnkgPSBiYWxhbmNlTWFuYWdlci5nZXRCYWxhbmNlSGlzdG9yeSg1KTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChoaXN0b3J5Lmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbCg1KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQmFsYW5jZSBBbGVydHMnLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdFxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlU3BvdEFjY291bnRzKVxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2FtcGxlVHJhZGVIaXN0b3J5KTtcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzZXQgYmFsYW5jZSBhbGVydCcsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYmFsYW5jZU1hbmFnZXIuc2V0QmFsYW5jZUFsZXJ0KCdCVEMnLCAnTE9XX0JBTEFOQ0UnLCAwLjEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGFsZXJ0cyA9IGJhbGFuY2VNYW5hZ2VyLmdldEJhbGFuY2VBbGVydHMoJ0JUQycpO1xyXG4gICAgICBleHBlY3QoYWxlcnRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgbG93QmFsYW5jZUFsZXJ0ID0gYWxlcnRzLmZpbmQoYSA9PiBhLmFsZXJ0VHlwZSA9PT0gJ0xPV19CQUxBTkNFJyk7XHJcbiAgICAgIGV4cGVjdChsb3dCYWxhbmNlQWxlcnQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChsb3dCYWxhbmNlQWxlcnQ/LnRocmVzaG9sZCkudG9CZSgwLjEpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZW1vdmUgYmFsYW5jZSBhbGVydCcsICgpID0+IHtcclxuICAgICAgYmFsYW5jZU1hbmFnZXIuc2V0QmFsYW5jZUFsZXJ0KCdCVEMnLCAnTE9XX0JBTEFOQ0UnLCAwLjEpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYmFsYW5jZU1hbmFnZXIucmVtb3ZlQmFsYW5jZUFsZXJ0KCdCVEMnLCAnTE9XX0JBTEFOQ0UnKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBhbGVydHMgPSBiYWxhbmNlTWFuYWdlci5nZXRCYWxhbmNlQWxlcnRzKCdCVEMnKTtcclxuICAgICAgY29uc3QgbG93QmFsYW5jZUFsZXJ0ID0gYWxlcnRzLmZpbmQoYSA9PiBhLmFsZXJ0VHlwZSA9PT0gJ0xPV19CQUxBTkNFJyk7XHJcbiAgICAgIGV4cGVjdChsb3dCYWxhbmNlQWxlcnQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2V0IGJhbGFuY2UgYWxlcnRzIGZvciBjdXJyZW5jeScsICgpID0+IHtcclxuICAgICAgYmFsYW5jZU1hbmFnZXIuc2V0QmFsYW5jZUFsZXJ0KCdCVEMnLCAnTE9XX0JBTEFOQ0UnLCAwLjEpO1xyXG4gICAgICBiYWxhbmNlTWFuYWdlci5zZXRCYWxhbmNlQWxlcnQoJ0JUQycsICdISUdIX0JBTEFOQ0UnLCAxMC4wKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGFsZXJ0cyA9IGJhbGFuY2VNYW5hZ2VyLmdldEJhbGFuY2VBbGVydHMoJ0JUQycpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGFsZXJ0cykudG9IYXZlTGVuZ3RoKDIpO1xyXG4gICAgICBleHBlY3QoYWxlcnRzLm1hcChhID0+IGEuYWxlcnRUeXBlKSkudG9Db250YWluKCdMT1dfQkFMQU5DRScpO1xyXG4gICAgICBleHBlY3QoYWxlcnRzLm1hcChhID0+IGEuYWxlcnRUeXBlKSkudG9Db250YWluKCdISUdIX0JBTEFOQ0UnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IGZvciBjdXJyZW5jeSB3aXRoIG5vIGFsZXJ0cycsICgpID0+IHtcclxuICAgICAgY29uc3QgYWxlcnRzID0gYmFsYW5jZU1hbmFnZXIuZ2V0QmFsYW5jZUFsZXJ0cygnRE9HRScpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGFsZXJ0cykudG9IYXZlTGVuZ3RoKDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdFbWVyZ2VuY3kgU3RvcCcsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG5vdCB0cmlnZ2VyIGVtZXJnZW5jeSBzdG9wIHdpdGggbm8gaGlzdG9yaWNhbCBkYXRhJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5jaGVja0VtZXJnZW5jeVN0b3AoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB0cmlnZ2VyIGVtZXJnZW5jeSBzdG9wIG9uIHNpZ25pZmljYW50IGxvc3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIENyZWF0ZSBoaXN0b3JpY2FsIHNuYXBzaG90IHdpdGggaGlnaGVyIHZhbHVlXHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGxhc3Q6ICc2MDAwMCcgfV0pIC8vIEhpZ2hlciBCVEMgcHJpY2UgZm9yIHNuYXBzaG90XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBsYXN0OiAnNDAwMCcgfV0pOyAvLyBIaWdoZXIgRVRIIHByaWNlIGZvciBzbmFwc2hvdFxyXG4gICAgICBcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuY3JlYXRlQmFsYW5jZVNuYXBzaG90KCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBNb2NrIGN1cnJlbnQgbG93ZXIgcHJpY2VzIChzaW11bGF0aW5nIGxvc3MpXHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGxhc3Q6ICc0MDAwMCcgfV0pIC8vIExvd2VyIEJUQyBwcmljZVxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoW3sgbGFzdDogJzIwMDAnIH1dKTsgLy8gTG93ZXIgRVRIIHByaWNlXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBlbWVyZ2VuY3lTdG9wU3B5ID0gamVzdC5mbigpO1xyXG4gICAgICBiYWxhbmNlTWFuYWdlci5vbignZW1lcmdlbmN5U3RvcCcsIGVtZXJnZW5jeVN0b3BTcHkpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYmFsYW5jZU1hbmFnZXIuY2hlY2tFbWVyZ2VuY3lTdG9wKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBUaGlzIHRlc3QgbWlnaHQgbm90IHRyaWdnZXIgZHVlIHRvIHRpbWluZyBjb25zdHJhaW50cyBpbiB0ZXN0IGVudmlyb25tZW50XHJcbiAgICAgIC8vIEluIGEgcmVhbCBzY2VuYXJpbywgeW91J2QgbmVlZCB0byBtYW5pcHVsYXRlIHRoZSBzbmFwc2hvdCB0aW1lc3RhbXBcclxuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQpLnRvQmUoJ2Jvb2xlYW4nKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnU3RhdGlzdGljcyBhbmQgQ29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBiYWxhbmNlIHN0YXRpc3RpY3MnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN0YXRzID0gYmFsYW5jZU1hbmFnZXIuZ2V0QmFsYW5jZVN0YXRzKCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCd0b3RhbEJhbGFuY2VDaGVja3MnKTtcclxuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgnZGlzY3JlcGFuY2llc0RldGVjdGVkJyk7XHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2FsZXJ0c1RyaWdnZXJlZCcpO1xyXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdiYWxhbmNlQWNjdXJhY3knKTtcclxuICAgICAgZXhwZWN0KHN0YXRzLnRvdGFsQmFsYW5jZUNoZWNrcykudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY3VycmVudCBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb25maWcgPSBiYWxhbmNlTWFuYWdlci5nZXRDb25maWcoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChjb25maWcpLnRvSGF2ZVByb3BlcnR5KCdlbmFibGVSZWFsVGltZU1vbml0b3JpbmcnKTtcclxuICAgICAgZXhwZWN0KGNvbmZpZykudG9IYXZlUHJvcGVydHkoJ21vbml0b3JpbmdJbnRlcnZhbCcpO1xyXG4gICAgICBleHBlY3QoY29uZmlnKS50b0hhdmVQcm9wZXJ0eSgnZGlzY3JlcGFuY3lUaHJlc2hvbGQnKTtcclxuICAgICAgZXhwZWN0KGNvbmZpZykudG9IYXZlUHJvcGVydHkoJ2VuYWJsZUFsZXJ0cycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgY29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgbmV3Q29uZmlnID0ge1xyXG4gICAgICAgIG1vbml0b3JpbmdJbnRlcnZhbDogNjAwMDAsXHJcbiAgICAgICAgZW5hYmxlQWxlcnRzOiBmYWxzZSxcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGJhbGFuY2VNYW5hZ2VyLnVwZGF0ZUNvbmZpZyhuZXdDb25maWcpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgY29uZmlnID0gYmFsYW5jZU1hbmFnZXIuZ2V0Q29uZmlnKCk7XHJcbiAgICAgIGV4cGVjdChjb25maWcubW9uaXRvcmluZ0ludGVydmFsKS50b0JlKDYwMDAwKTtcclxuICAgICAgZXhwZWN0KGNvbmZpZy5lbmFibGVBbGVydHMpLnRvQmUoZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkgZXJyb3JzIGluIGJhbGFuY2UgcmV0cmlldmFsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0Lm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignQVBJIGVycm9yJykpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgZXhwZWN0KGJhbGFuY2VNYW5hZ2VyLmdldEN1cnJlbnRCYWxhbmNlcyh0cnVlKSkucmVqZWN0cy50b1Rocm93KCdBUEkgZXJyb3InKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvcnMgaW4gdmFsaWRhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1ZhbGlkYXRpb24gQVBJIGVycm9yJykpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgZXhwZWN0KGJhbGFuY2VNYW5hZ2VyLnZhbGlkYXRlQmFsYW5jZXMoKSkucmVqZWN0cy50b1Rocm93KCdWYWxpZGF0aW9uIEFQSSBlcnJvcicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQVBJIGVycm9ycyBpbiByZWNvbmNpbGlhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1JlY29uY2lsaWF0aW9uIEFQSSBlcnJvcicpKTtcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IGV4cGVjdChiYWxhbmNlTWFuYWdlci5yZWNvbmNpbGVUcmFuc2FjdGlvbnMoKSkucmVqZWN0cy50b1Rocm93KCdSZWNvbmNpbGlhdGlvbiBBUEkgZXJyb3InKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgYmFsYW5jZSBkYXRhIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJhbGFuY2UgPSBhd2FpdCBiYWxhbmNlTWFuYWdlci5nZXRCYWxhbmNlKCdOT05FWElTVEVOVCcpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvQmVOdWxsKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0V2ZW50IEVtaXNzaW9uJywgKCkgPT4ge1xyXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNhbXBsZVNwb3RBY2NvdW50cylcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNhbXBsZVRyYWRlSGlzdG9yeSk7XHJcbiAgICAgIGF3YWl0IGJhbGFuY2VNYW5hZ2VyLmluaXRpYWxpemUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZW1pdCBiYWxhbmNlIGFsZXJ0IGV2ZW50cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgYWxlcnRTcHkgPSBqZXN0LmZuKCk7XHJcbiAgICAgIGJhbGFuY2VNYW5hZ2VyLm9uKCdiYWxhbmNlQWxlcnQnLCBhbGVydFNweSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTZXQgYSBsb3cgYmFsYW5jZSBhbGVydCB0aGF0IHNob3VsZCB0cmlnZ2VyXHJcbiAgICAgIGJhbGFuY2VNYW5hZ2VyLnNldEJhbGFuY2VBbGVydCgnQlRDJywgJ0xPV19CQUxBTkNFJywgMTAuMCk7IC8vIEhpZ2hlciB0aGFuIGN1cnJlbnQgYmFsYW5jZVxyXG4gICAgICBcclxuICAgICAgLy8gVGhpcyB3b3VsZCByZXF1aXJlIHRyaWdnZXJpbmcgdGhlIGFsZXJ0IGNoZWNrIG1lY2hhbmlzbVxyXG4gICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHRoaXMgd291bGQgYmUgdHJpZ2dlcmVkIGJ5IHRoZSBtb25pdG9yaW5nIGludGVydmFsXHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGVtaXQgZW1lcmdlbmN5IHN0b3AgZXZlbnRzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBlbWVyZ2VuY3lTdG9wU3B5ID0gamVzdC5mbigpO1xyXG4gICAgICBiYWxhbmNlTWFuYWdlci5vbignZW1lcmdlbmN5U3RvcCcsIGVtZXJnZW5jeVN0b3BTcHkpO1xyXG4gICAgICBcclxuICAgICAgLy8gVGhpcyB3b3VsZCByZXF1aXJlIHNldHRpbmcgdXAgY29uZGl0aW9ucyBmb3IgZW1lcmdlbmN5IHN0b3BcclxuICAgICAgLy8gYW5kIHRyaWdnZXJpbmcgdGhlIGNoZWNrIG1lY2hhbmlzbVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdTaHV0ZG93bicsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBhd2FpdCBiYWxhbmNlTWFuYWdlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHNodXRkb3duIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIE1vY2sgc25hcHNob3QgY3JlYXRpb24gZHVyaW5nIHNodXRkb3duXHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKFt7IGxhc3Q6ICc1MDAwMCcgfV0pXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShbeyBsYXN0OiAnMzAwMCcgfV0pO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuc2h1dGRvd24oKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChtb2NrQXVkaXRTZXJ2aWNlLmxvZ1NlY3VyaXR5RXZlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgIHR5cGU6ICdCQUxBTkNFX01BTkFHRVJfU0hVVERPV04nLFxyXG4gICAgICAgICAgc2V2ZXJpdHk6ICdJTkZPJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1JlYWwtdGltZSBNb25pdG9yaW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBzdGFydCBtb25pdG9yaW5nIHdoZW4gZW5hYmxlZCBpbiBjb25maWcnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHsgZW5hYmxlUmVhbFRpbWVNb25pdG9yaW5nOiB0cnVlLCBtb25pdG9yaW5nSW50ZXJ2YWw6IDEwMDAgfTtcclxuICAgICAgXHJcbiAgICAgIG1vY2tHYXRlSU9DbGllbnQubWFrZVJlcXVlc3RcclxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUoc2FtcGxlU3BvdEFjY291bnRzKVxyXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuaW5pdGlhbGl6ZShjb25maWcpO1xyXG4gICAgICBcclxuICAgICAgLy8gTW9uaXRvcmluZyB3b3VsZCBiZSBzdGFydGVkIGF1dG9tYXRpY2FsbHlcclxuICAgICAgLy8gSW4gYSByZWFsIHRlc3QsIHlvdSBtaWdodCB3YW50IHRvIHZlcmlmeSB0aW1lciBjcmVhdGlvblxyXG4gICAgICBleHBlY3QobW9ja0dhdGVJT0NsaWVudC5tYWtlUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBub3Qgc3RhcnQgbW9uaXRvcmluZyB3aGVuIGRpc2FibGVkIGluIGNvbmZpZycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgY29uZmlnID0geyBlbmFibGVSZWFsVGltZU1vbml0b3Jpbmc6IGZhbHNlIH07XHJcbiAgICAgIFxyXG4gICAgICBtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0XHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVTcG90QWNjb3VudHMpXHJcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShzYW1wbGVUcmFkZUhpc3RvcnkpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgYmFsYW5jZU1hbmFnZXIuaW5pdGlhbGl6ZShjb25maWcpO1xyXG4gICAgICBcclxuICAgICAgLy8gU2hvdWxkIG9ubHkgYmUgY2FsbGVkIGR1cmluZyBpbml0aWFsaXphdGlvbiwgbm90IGZvciBtb25pdG9yaW5nXHJcbiAgICAgIGV4cGVjdChtb2NrR2F0ZUlPQ2xpZW50Lm1ha2VSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9