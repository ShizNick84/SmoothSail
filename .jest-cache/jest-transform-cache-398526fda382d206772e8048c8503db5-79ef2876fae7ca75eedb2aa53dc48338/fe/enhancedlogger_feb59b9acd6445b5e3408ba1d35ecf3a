96968c6da40a2bcd7bbbbbf6e355030d
"use strict";
/**
 * =============================================================================
 * ENHANCED LOGGER WITH RICH FORMATTING AND VISUAL INDICATORS
 * =============================================================================
 *
 * This module extends the base logger with rich formatting, emojis, and
 * visual indicators for better log readability and monitoring.
 *
 * Features:
 * - Emoji-based status indicators
 * - Color-coded log levels
 * - Contextual information enrichment
 * - Performance metrics integration
 * - Visual progress indicators
 *
 * @author AI Crypto Trading System
 * @version 1.0.0
 * =============================================================================
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.enhancedLogger = exports.EnhancedLogger = exports.LogColors = exports.LogEmojis = void 0;
const logger_1 = require("./logger");
const chalk_1 = __importDefault(require("chalk"));
/**
 * Emoji mappings for different log types and statuses
 */
exports.LogEmojis = {
    // System status
    SUCCESS: 'âœ…',
    ERROR: 'âŒ',
    WARNING: 'âš ï¸',
    INFO: 'â„¹ï¸',
    DEBUG: 'ðŸ”',
    // Trading operations
    BUY: 'ðŸ“ˆ',
    SELL: 'ðŸ“‰',
    PROFIT: 'ðŸ’°',
    LOSS: 'ðŸ’¸',
    BALANCE: 'âš–ï¸',
    PORTFOLIO: 'ðŸ“Š',
    // System operations
    START: 'ðŸš€',
    STOP: 'ðŸ›‘',
    RESTART: 'ðŸ”„',
    INITIALIZE: 'ðŸ”§',
    SHUTDOWN: 'â¹ï¸',
    // Network and connectivity
    CONNECTED: 'ðŸ”—',
    DISCONNECTED: 'ðŸ”Œ',
    TUNNEL: 'ðŸš‡',
    API: 'ðŸŒ',
    DATABASE: 'ðŸ—„ï¸',
    // Security and monitoring
    SECURITY: 'ðŸ”’',
    AUDIT: 'ðŸ“‹',
    ALERT: 'ðŸš¨',
    MONITOR: 'ðŸ‘ï¸',
    BACKUP: 'ðŸ’¾',
    // Performance
    FAST: 'âš¡',
    SLOW: 'ðŸŒ',
    MEMORY: 'ðŸ§ ',
    CPU: 'âš™ï¸',
    DISK: 'ðŸ’½',
    // Market data
    BULL: 'ðŸ‚',
    BEAR: 'ðŸ»',
    ROCKET: 'ðŸš€',
    CRASH: 'ðŸ’¥',
    TREND_UP: 'ðŸ“ˆ',
    TREND_DOWN: 'ðŸ“‰',
    // Notifications
    TELEGRAM: 'ðŸ“±',
    EMAIL: 'ðŸ“§',
    BELL: 'ðŸ””',
    MUTE: 'ðŸ”•'
};
/**
 * Color schemes for different log levels
 */
exports.LogColors = {
    ERROR: chalk_1.default.red,
    WARN: chalk_1.default.yellow,
    INFO: chalk_1.default.blue,
    DEBUG: chalk_1.default.gray,
    SUCCESS: chalk_1.default.green,
    TRADING: chalk_1.default.magenta,
    SECURITY: chalk_1.default.cyan,
    PERFORMANCE: chalk_1.default.white
};
/**
 * Enhanced logger with rich formatting and visual indicators
 */
class EnhancedLogger extends logger_1.Logger {
    performanceMetrics = new Map();
    operationCounters = new Map();
    constructor(componentName) {
        super(componentName);
    }
    /**
     * Log with emoji and rich formatting
     */
    logWithEmoji(level, emoji, message, meta) {
        const formattedMessage = `${emoji} ${message}`;
        switch (level) {
            case 'info':
                this.info(formattedMessage, meta);
                break;
            case 'warn':
                this.warn(formattedMessage, meta);
                break;
            case 'error':
                this.error(formattedMessage, meta);
                break;
            case 'debug':
                this.debug(formattedMessage, meta);
                break;
        }
    }
    /**
     * Log trading operations with rich context
     */
    logTradingOperation(operation, symbol, amount, price, profit, meta) {
        const emoji = exports.LogEmojis[operation];
        let message = `${operation} operation`;
        const enrichedMeta = {
            ...meta,
            symbol,
            operation: operation.toLowerCase(),
            timestamp: new Date().toISOString()
        };
        if (amount !== undefined) {
            message += ` - Amount: ${amount}`;
            enrichedMeta.amount = amount;
        }
        if (price !== undefined) {
            message += ` - Price: $${price.toFixed(4)}`;
            enrichedMeta.price = price;
        }
        if (profit !== undefined) {
            const profitEmoji = profit > 0 ? exports.LogEmojis.PROFIT : exports.LogEmojis.LOSS;
            message += ` - P&L: ${profitEmoji} $${profit.toFixed(2)}`;
            enrichedMeta.profit = profit;
        }
        this.trading(operation.toLowerCase(), `${emoji} ${message}`, enrichedMeta);
        this.incrementCounter(`trading_${operation.toLowerCase()}`);
    }
    /**
     * Log system status with visual indicators
     */
    logSystemStatus(status, component, details, meta) {
        const statusEmojis = {
            HEALTHY: exports.LogEmojis.SUCCESS,
            WARNING: exports.LogEmojis.WARNING,
            CRITICAL: exports.LogEmojis.ERROR,
            STARTING: exports.LogEmojis.START,
            STOPPING: exports.LogEmojis.STOP
        };
        const emoji = statusEmojis[status];
        const message = `System ${status.toLowerCase()}: ${component}`;
        const enrichedMeta = {
            ...meta,
            component,
            status: status.toLowerCase(),
            details,
            timestamp: new Date().toISOString()
        };
        const level = status === 'CRITICAL' ? 'error' :
            status === 'WARNING' ? 'warn' : 'info';
        this.logWithEmoji(level, emoji, message, enrichedMeta);
    }
    /**
     * Log performance metrics with visual indicators
     */
    logPerformance(metric, value, unit, threshold, meta) {
        let emoji = exports.LogEmojis.INFO;
        let level = 'info';
        if (threshold) {
            if (value >= threshold.critical) {
                emoji = exports.LogEmojis.ERROR;
                level = 'error';
            }
            else if (value >= threshold.warning) {
                emoji = exports.LogEmojis.WARNING;
                level = 'warn';
            }
            else {
                emoji = exports.LogEmojis.SUCCESS;
            }
        }
        const message = `Performance metric: ${metric} = ${value}${unit}`;
        const enrichedMeta = {
            ...meta,
            metric,
            value,
            unit,
            threshold,
            timestamp: new Date().toISOString()
        };
        this.logWithEmoji(level, emoji, message, enrichedMeta);
        this.performanceMetrics.set(metric, value);
    }
    /**
     * Log network connectivity status
     */
    logConnectivity(service, status, latency, meta) {
        const statusEmojis = {
            CONNECTED: exports.LogEmojis.CONNECTED,
            DISCONNECTED: exports.LogEmojis.DISCONNECTED,
            RECONNECTING: exports.LogEmojis.RESTART,
            TIMEOUT: exports.LogEmojis.WARNING
        };
        const emoji = statusEmojis[status];
        let message = `${service} ${status.toLowerCase()}`;
        if (latency !== undefined) {
            const latencyEmoji = latency < 100 ? exports.LogEmojis.FAST :
                latency < 500 ? exports.LogEmojis.INFO : exports.LogEmojis.SLOW;
            message += ` ${latencyEmoji} (${latency}ms)`;
        }
        const enrichedMeta = {
            ...meta,
            service,
            status: status.toLowerCase(),
            latency,
            timestamp: new Date().toISOString()
        };
        const level = status === 'DISCONNECTED' || status === 'TIMEOUT' ? 'warn' : 'info';
        this.logWithEmoji(level, emoji, message, enrichedMeta);
    }
    /**
     * Log market sentiment and analysis
     */
    logMarketSentiment(symbol, sentiment, confidence, indicators, meta) {
        const sentimentEmojis = {
            BULLISH: exports.LogEmojis.BULL,
            BEARISH: exports.LogEmojis.BEAR,
            NEUTRAL: exports.LogEmojis.BALANCE
        };
        const emoji = sentimentEmojis[sentiment];
        const message = `Market sentiment for ${symbol}: ${sentiment} (${(confidence * 100).toFixed(1)}% confidence)`;
        const enrichedMeta = {
            ...meta,
            symbol,
            sentiment: sentiment.toLowerCase(),
            confidence,
            indicators,
            timestamp: new Date().toISOString()
        };
        this.trading('market_analysis', `${emoji} ${message}`, enrichedMeta);
    }
    /**
     * Log notification delivery status
     */
    logNotification(channel, status, recipient, meta) {
        const channelEmojis = {
            TELEGRAM: exports.LogEmojis.TELEGRAM,
            EMAIL: exports.LogEmojis.EMAIL,
            WEBHOOK: exports.LogEmojis.API
        };
        const statusEmojis = {
            SENT: exports.LogEmojis.SUCCESS,
            FAILED: exports.LogEmojis.ERROR,
            QUEUED: exports.LogEmojis.INFO
        };
        const channelEmoji = channelEmojis[channel];
        const statusEmoji = statusEmojis[status];
        let message = `${channelEmoji} ${channel} notification ${status.toLowerCase()}`;
        if (recipient) {
            message += ` to ${recipient}`;
        }
        const enrichedMeta = {
            ...meta,
            channel: channel.toLowerCase(),
            status: status.toLowerCase(),
            recipient,
            timestamp: new Date().toISOString()
        };
        const level = status === 'FAILED' ? 'error' : 'info';
        this.logWithEmoji(level, statusEmoji, message, enrichedMeta);
    }
    /**
     * Log security events with appropriate classification
     */
    logSecurityEvent(eventType, severity, details, meta) {
        const severityEmojis = {
            LOW: exports.LogEmojis.INFO,
            MEDIUM: exports.LogEmojis.WARNING,
            HIGH: exports.LogEmojis.ALERT,
            CRITICAL: exports.LogEmojis.ERROR
        };
        const emoji = severityEmojis[severity];
        const message = `${exports.LogEmojis.SECURITY} Security event: ${eventType} - ${details}`;
        const enrichedMeta = {
            ...meta,
            eventType: eventType.toLowerCase(),
            severity: severity.toLowerCase(),
            classification: 'CONFIDENTIAL',
            timestamp: new Date().toISOString()
        };
        const level = severity === 'CRITICAL' || severity === 'HIGH' ? 'error' :
            severity === 'MEDIUM' ? 'warn' : 'info';
        this.security(eventType.toLowerCase(), `${emoji} ${message}`, enrichedMeta);
    }
    /**
     * Create a progress indicator for long-running operations
     */
    logProgress(operation, current, total, meta) {
        const percentage = Math.round((current / total) * 100);
        const progressBar = this.createProgressBar(percentage);
        const emoji = percentage === 100 ? exports.LogEmojis.SUCCESS : exports.LogEmojis.INFO;
        const message = `${operation} progress: ${progressBar} ${percentage}% (${current}/${total})`;
        const enrichedMeta = {
            ...meta,
            operation,
            current,
            total,
            percentage,
            timestamp: new Date().toISOString()
        };
        this.logWithEmoji('info', emoji, message, enrichedMeta);
    }
    /**
     * Create a visual progress bar
     */
    createProgressBar(percentage, width = 20) {
        const filled = Math.round((percentage / 100) * width);
        const empty = width - filled;
        return 'â–ˆ'.repeat(filled) + 'â–‘'.repeat(empty);
    }
    /**
     * Increment operation counter
     */
    incrementCounter(operation) {
        const current = this.operationCounters.get(operation) || 0;
        this.operationCounters.set(operation, current + 1);
    }
    /**
     * Get current performance metrics
     */
    getPerformanceMetrics() {
        return Object.fromEntries(this.performanceMetrics);
    }
    /**
     * Get operation counters
     */
    getOperationCounters() {
        return Object.fromEntries(this.operationCounters);
    }
    /**
     * Reset all counters and metrics
     */
    resetMetrics() {
        this.performanceMetrics.clear();
        this.operationCounters.clear();
    }
    /**
     * Generate a summary report of logging activity
     */
    generateLogSummary() {
        return {
            metrics: this.getPerformanceMetrics(),
            counters: this.getOperationCounters(),
            timestamp: new Date().toISOString()
        };
    }
}
exports.EnhancedLogger = EnhancedLogger;
// Create and export enhanced logger instance
exports.enhancedLogger = new EnhancedLogger();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxOaWNrXFxEZXNrdG9wXFxTbW9vdGhTYWlsXFxzcmNcXGNvcmVcXGxvZ2dpbmdcXGVuaGFuY2VkLWxvZ2dlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCRzs7Ozs7O0FBRUgscUNBQStDO0FBQy9DLGtEQUEwQjtBQUUxQjs7R0FFRztBQUNVLFFBQUEsU0FBUyxHQUFHO0lBQ3ZCLGdCQUFnQjtJQUNoQixPQUFPLEVBQUUsR0FBRztJQUNaLEtBQUssRUFBRSxHQUFHO0lBQ1YsT0FBTyxFQUFFLElBQUk7SUFDYixJQUFJLEVBQUUsSUFBSTtJQUNWLEtBQUssRUFBRSxJQUFJO0lBRVgscUJBQXFCO0lBQ3JCLEdBQUcsRUFBRSxJQUFJO0lBQ1QsSUFBSSxFQUFFLElBQUk7SUFDVixNQUFNLEVBQUUsSUFBSTtJQUNaLElBQUksRUFBRSxJQUFJO0lBQ1YsT0FBTyxFQUFFLElBQUk7SUFDYixTQUFTLEVBQUUsSUFBSTtJQUVmLG9CQUFvQjtJQUNwQixLQUFLLEVBQUUsSUFBSTtJQUNYLElBQUksRUFBRSxJQUFJO0lBQ1YsT0FBTyxFQUFFLElBQUk7SUFDYixVQUFVLEVBQUUsSUFBSTtJQUNoQixRQUFRLEVBQUUsSUFBSTtJQUVkLDJCQUEyQjtJQUMzQixTQUFTLEVBQUUsSUFBSTtJQUNmLFlBQVksRUFBRSxJQUFJO0lBQ2xCLE1BQU0sRUFBRSxJQUFJO0lBQ1osR0FBRyxFQUFFLElBQUk7SUFDVCxRQUFRLEVBQUUsS0FBSztJQUVmLDBCQUEwQjtJQUMxQixRQUFRLEVBQUUsSUFBSTtJQUNkLEtBQUssRUFBRSxJQUFJO0lBQ1gsS0FBSyxFQUFFLElBQUk7SUFDWCxPQUFPLEVBQUUsS0FBSztJQUNkLE1BQU0sRUFBRSxJQUFJO0lBRVosY0FBYztJQUNkLElBQUksRUFBRSxHQUFHO0lBQ1QsSUFBSSxFQUFFLElBQUk7SUFDVixNQUFNLEVBQUUsSUFBSTtJQUNaLEdBQUcsRUFBRSxJQUFJO0lBQ1QsSUFBSSxFQUFFLElBQUk7SUFFVixjQUFjO0lB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QyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxvQkFBb0I7UUFDekIsT0FBTyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRDs7T0FFRztJQUNJLFlBQVk7UUFDakIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNqQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxrQkFBa0I7UUFLdkIsT0FBTztZQUNMLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLEVBQUU7WUFDckMsUUFBUSxFQUFFLElBQUksQ0FBQyxvQkFBb0IsRUFBRTtZQUNyQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7U0FDcEMsQ0FBQztJQUNKLENBQUM7Q0FDRjtBQXBYRCx3Q0FvWEM7QUFFRCw2Q0FBNkM7QUFDaEMsUUFBQSxjQUFjLEdBQUcsSUFBSSxjQUFjLEVBQUUsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXE5pY2tcXERlc2t0b3BcXFNtb290aFNhaWxcXHNyY1xcY29yZVxcbG9nZ2luZ1xcZW5oYW5jZWQtbG9nZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBFTkhBTkNFRCBMT0dHRVIgV0lUSCBSSUNIIEZPUk1BVFRJTkcgQU5EIFZJU1VBTCBJTkRJQ0FUT1JTXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqIFxyXG4gKiBUaGlzIG1vZHVsZSBleHRlbmRzIHRoZSBiYXNlIGxvZ2dlciB3aXRoIHJpY2ggZm9ybWF0dGluZywgZW1vamlzLCBhbmRcclxuICogdmlzdWFsIGluZGljYXRvcnMgZm9yIGJldHRlciBsb2cgcmVhZGFiaWxpdHkgYW5kIG1vbml0b3JpbmcuXHJcbiAqIFxyXG4gKiBGZWF0dXJlczpcclxuICogLSBFbW9qaS1iYXNlZCBzdGF0dXMgaW5kaWNhdG9yc1xyXG4gKiAtIENvbG9yLWNvZGVkIGxvZyBsZXZlbHNcclxuICogLSBDb250ZXh0dWFsIGluZm9ybWF0aW9uIGVucmljaG1lbnRcclxuICogLSBQZXJmb3JtYW5jZSBtZXRyaWNzIGludGVncmF0aW9uXHJcbiAqIC0gVmlzdWFsIHByb2dyZXNzIGluZGljYXRvcnNcclxuICogXHJcbiAqIEBhdXRob3IgQUkgQ3J5cHRvIFRyYWRpbmcgU3lzdGVtXHJcbiAqIEB2ZXJzaW9uIDEuMC4wXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTG9nZ2VyLCBMb2dNZXRhZGF0YSB9IGZyb20gJy4vbG9nZ2VyJztcclxuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJztcclxuXHJcbi8qKlxyXG4gKiBFbW9qaSBtYXBwaW5ncyBmb3IgZGlmZmVyZW50IGxvZyB0eXBlcyBhbmQgc3RhdHVzZXNcclxuICovXHJcbmV4cG9ydCBjb25zdCBMb2dFbW9qaXMgPSB7XHJcbiAgLy8gU3lzdGVtIHN0YXR1c1xyXG4gIFNVQ0NFU1M6ICfinIUnLFxyXG4gIEVSUk9SOiAn4p2MJyxcclxuICBXQVJOSU5HOiAn4pqg77iPJyxcclxuICBJTkZPOiAn4oS577iPJyxcclxuICBERUJVRzogJ/CflI0nLFxyXG4gIFxyXG4gIC8vIFRyYWRpbmcgb3BlcmF0aW9uc1xyXG4gIEJVWTogJ/Cfk4gnLFxyXG4gIFNFTEw6ICfwn5OJJyxcclxuICBQUk9GSVQ6ICfwn5KwJyxcclxuICBMT1NTOiAn8J+SuCcsXHJcbiAgQkFMQU5DRTogJ+Kalu+4jycsXHJcbiAgUE9SVEZPTElPOiAn8J+TiicsXHJcbiAgXHJcbiAgLy8gU3lzdGVtIG9wZXJhdGlvbnNcclxuICBTVEFSVDogJ/CfmoAnLFxyXG4gIFNUT1A6ICfwn5uRJyxcclxuICBSRVNUQVJUOiAn8J+UhCcsXHJcbiAgSU5JVElBTElaRTogJ/CflKcnLFxyXG4gIFNIVVRET1dOOiAn4o+577iPJyxcclxuICBcclxuICAvLyBOZXR3b3JrIGFuZCBjb25uZWN0aXZpdHlcclxuICBDT05ORUNURUQ6ICfwn5SXJyxcclxuICBESVNDT05ORUNURUQ6ICfwn5SMJyxcclxuICBUVU5ORUw6ICfwn5qHJyxcclxuICBBUEk6ICfwn4yQJyxcclxuICBEQVRBQkFTRTogJ/Cfl4TvuI8nLFxyXG4gIFxyXG4gIC8vIFNlY3VyaXR5IGFuZCBtb25pdG9yaW5nXHJcbiAgU0VDVVJJVFk6ICfwn5SSJyxcclxuICBBVURJVDogJ/Cfk4snLFxyXG4gIEFMRVJUOiAn8J+aqCcsXHJcbiAgTU9OSVRPUjogJ/CfkYHvuI8nLFxyXG4gIEJBQ0tVUDogJ/Cfkr4nLFxyXG4gIFxyXG4gIC8vIFBlcmZvcm1hbmNlXHJcbiAgRkFTVDogJ+KaoScsXHJcbiAgU0xPVzogJ/CfkIwnLFxyXG4gIE1FTU9SWTogJ/Cfp6AnLFxyXG4gIENQVTogJ+Kame+4jycsXHJcbiAgRElTSzogJ/Cfkr0nLFxyXG4gIFxyXG4gIC8vIE1hcmtldCBkYXRhXHJcbiAgQlVMTDogJ/CfkIInLFxyXG4gIEJFQVI6ICfwn5C7JyxcclxuICBST0NLRVQ6ICfwn5qAJyxcclxuICBDUkFTSDogJ/CfkqUnLFxyXG4gIFRSRU5EX1VQOiAn8J+TiCcsXHJcbiAgVFJFTkRfRE9XTjogJ/Cfk4knLFxyXG4gIFxyXG4gIC8vIE5vdGlmaWNhdGlvbnNcclxuICBURUxFR1JBTTogJ/Cfk7EnLFxyXG4gIEVNQUlMOiAn8J+TpycsXHJcbiAgQkVMTDogJ/CflJQnLFxyXG4gIE1VVEU6ICfwn5SVJ1xyXG59IGFzIGNvbnN0O1xyXG5cclxuLyoqXHJcbiAqIENvbG9yIHNjaGVtZXMgZm9yIGRpZmZlcmVudCBsb2cgbGV2ZWxzXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgTG9nQ29sb3JzID0ge1xyXG4gIEVSUk9SOiBjaGFsay5yZWQsXHJcbiAgV0FSTjogY2hhbGsueWVsbG93LFxyXG4gIElORk86IGNoYWxrLmJsdWUsXHJcbiAgREVCVUc6IGNoYWxrLmdyYXksXHJcbiAgU1VDQ0VTUzogY2hhbGsuZ3JlZW4sXHJcbiAgVFJBRElORzogY2hhbGsubWFnZW50YSxcclxuICBTRUNVUklUWTogY2hhbGsuY3lhbixcclxuICBQRVJGT1JNQU5DRTogY2hhbGsud2hpdGVcclxufSBhcyBjb25zdDtcclxuXHJcbi8qKlxyXG4gKiBFbmhhbmNlZCBsb2dnZXIgd2l0aCByaWNoIGZvcm1hdHRpbmcgYW5kIHZpc3VhbCBpbmRpY2F0b3JzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRW5oYW5jZWRMb2dnZXIgZXh0ZW5kcyBMb2dnZXIge1xyXG4gIHByaXZhdGUgcGVyZm9ybWFuY2VNZXRyaWNzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgb3BlcmF0aW9uQ291bnRlcnM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbXBvbmVudE5hbWU/OiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKGNvbXBvbmVudE5hbWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIHdpdGggZW1vamkgYW5kIHJpY2ggZm9ybWF0dGluZ1xyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2dXaXRoRW1vamkoXHJcbiAgICBsZXZlbDogJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJyB8ICdkZWJ1ZycsXHJcbiAgICBlbW9qaTogc3RyaW5nLFxyXG4gICAgbWVzc2FnZTogc3RyaW5nLFxyXG4gICAgbWV0YT86IExvZ01ldGFkYXRhXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gYCR7ZW1vaml9ICR7bWVzc2FnZX1gO1xyXG4gICAgXHJcbiAgICBzd2l0Y2ggKGxldmVsKSB7XHJcbiAgICAgIGNhc2UgJ2luZm8nOlxyXG4gICAgICAgIHRoaXMuaW5mbyhmb3JtYXR0ZWRNZXNzYWdlLCBtZXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnd2Fybic6XHJcbiAgICAgICAgdGhpcy53YXJuKGZvcm1hdHRlZE1lc3NhZ2UsIG1ldGEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgdGhpcy5lcnJvcihmb3JtYXR0ZWRNZXNzYWdlLCBtZXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZGVidWcnOlxyXG4gICAgICAgIHRoaXMuZGVidWcoZm9ybWF0dGVkTWVzc2FnZSwgbWV0YSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgdHJhZGluZyBvcGVyYXRpb25zIHdpdGggcmljaCBjb250ZXh0XHJcbiAgICovXHJcbiAgcHVibGljIGxvZ1RyYWRpbmdPcGVyYXRpb24oXHJcbiAgICBvcGVyYXRpb246ICdCVVknIHwgJ1NFTEwnIHwgJ1BST0ZJVCcgfCAnTE9TUycgfCAnQkFMQU5DRV9DSEVDSycsXHJcbiAgICBzeW1ib2w6IHN0cmluZyxcclxuICAgIGFtb3VudD86IG51bWJlcixcclxuICAgIHByaWNlPzogbnVtYmVyLFxyXG4gICAgcHJvZml0PzogbnVtYmVyLFxyXG4gICAgbWV0YT86IExvZ01ldGFkYXRhXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBlbW9qaSA9IExvZ0Vtb2ppc1tvcGVyYXRpb25dO1xyXG4gICAgbGV0IG1lc3NhZ2UgPSBgJHtvcGVyYXRpb259IG9wZXJhdGlvbmA7XHJcbiAgICBcclxuICAgIGNvbnN0IGVucmljaGVkTWV0YTogTG9nTWV0YWRhdGEgPSB7XHJcbiAgICAgIC4uLm1ldGEsXHJcbiAgICAgIHN5bWJvbCxcclxuICAgICAgb3BlcmF0aW9uOiBvcGVyYXRpb24udG9Mb3dlckNhc2UoKSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcblxyXG4gICAgaWYgKGFtb3VudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIG1lc3NhZ2UgKz0gYCAtIEFtb3VudDogJHthbW91bnR9YDtcclxuICAgICAgZW5yaWNoZWRNZXRhLmFtb3VudCA9IGFtb3VudDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHByaWNlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgbWVzc2FnZSArPSBgIC0gUHJpY2U6ICQke3ByaWNlLnRvRml4ZWQoNCl9YDtcclxuICAgICAgZW5yaWNoZWRNZXRhLnByaWNlID0gcHJpY2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChwcm9maXQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBjb25zdCBwcm9maXRFbW9qaSA9IHByb2ZpdCA+IDAgPyBMb2dFbW9qaXMuUFJPRklUIDogTG9nRW1vamlzLkxPU1M7XHJcbiAgICAgIG1lc3NhZ2UgKz0gYCAtIFAmTDogJHtwcm9maXRFbW9qaX0gJCR7cHJvZml0LnRvRml4ZWQoMil9YDtcclxuICAgICAgZW5yaWNoZWRNZXRhLnByb2ZpdCA9IHByb2ZpdDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnRyYWRpbmcob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCksIGAke2Vtb2ppfSAke21lc3NhZ2V9YCwgZW5yaWNoZWRNZXRhKTtcclxuICAgIHRoaXMuaW5jcmVtZW50Q291bnRlcihgdHJhZGluZ18ke29wZXJhdGlvbi50b0xvd2VyQ2FzZSgpfWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIHN5c3RlbSBzdGF0dXMgd2l0aCB2aXN1YWwgaW5kaWNhdG9yc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2dTeXN0ZW1TdGF0dXMoXHJcbiAgICBzdGF0dXM6ICdIRUFMVEhZJyB8ICdXQVJOSU5HJyB8ICdDUklUSUNBTCcgfCAnU1RBUlRJTkcnIHwgJ1NUT1BQSU5HJyxcclxuICAgIGNvbXBvbmVudDogc3RyaW5nLFxyXG4gICAgZGV0YWlscz86IFJlY29yZDxzdHJpbmcsIGFueT4sXHJcbiAgICBtZXRhPzogTG9nTWV0YWRhdGFcclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHN0YXR1c0Vtb2ppcyA9IHtcclxuICAgICAgSEVBTFRIWTogTG9nRW1vamlzLlNVQ0NFU1MsXHJcbiAgICAgIFdBUk5JTkc6IExvZ0Vtb2ppcy5XQVJOSU5HLFxyXG4gICAgICBDUklUSUNBTDogTG9nRW1vamlzLkVSUk9SLFxyXG4gICAgICBTVEFSVElORzogTG9nRW1vamlzLlNUQVJULFxyXG4gICAgICBTVE9QUElORzogTG9nRW1vamlzLlNUT1BcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgZW1vamkgPSBzdGF0dXNFbW9qaXNbc3RhdHVzXTtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBgU3lzdGVtICR7c3RhdHVzLnRvTG93ZXJDYXNlKCl9OiAke2NvbXBvbmVudH1gO1xyXG4gICAgXHJcbiAgICBjb25zdCBlbnJpY2hlZE1ldGE6IExvZ01ldGFkYXRhID0ge1xyXG4gICAgICAuLi5tZXRhLFxyXG4gICAgICBjb21wb25lbnQsXHJcbiAgICAgIHN0YXR1czogc3RhdHVzLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIGRldGFpbHMsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGxldmVsID0gc3RhdHVzID09PSAnQ1JJVElDQUwnID8gJ2Vycm9yJyA6IFxyXG4gICAgICAgICAgICAgICAgIHN0YXR1cyA9PT0gJ1dBUk5JTkcnID8gJ3dhcm4nIDogJ2luZm8nO1xyXG4gICAgXHJcbiAgICB0aGlzLmxvZ1dpdGhFbW9qaShsZXZlbCwgZW1vamksIG1lc3NhZ2UsIGVucmljaGVkTWV0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgcGVyZm9ybWFuY2UgbWV0cmljcyB3aXRoIHZpc3VhbCBpbmRpY2F0b3JzXHJcbiAgICovXHJcbiAgcHVibGljIGxvZ1BlcmZvcm1hbmNlKFxyXG4gICAgbWV0cmljOiBzdHJpbmcsXHJcbiAgICB2YWx1ZTogbnVtYmVyLFxyXG4gICAgdW5pdDogc3RyaW5nLFxyXG4gICAgdGhyZXNob2xkPzogeyB3YXJuaW5nOiBudW1iZXI7IGNyaXRpY2FsOiBudW1iZXIgfSxcclxuICAgIG1ldGE/OiBMb2dNZXRhZGF0YVxyXG4gICk6IHZvaWQge1xyXG4gICAgbGV0IGVtb2ppID0gTG9nRW1vamlzLklORk87XHJcbiAgICBsZXQgbGV2ZWw6ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcicgPSAnaW5mbyc7XHJcbiAgICBcclxuICAgIGlmICh0aHJlc2hvbGQpIHtcclxuICAgICAgaWYgKHZhbHVlID49IHRocmVzaG9sZC5jcml0aWNhbCkge1xyXG4gICAgICAgIGVtb2ppID0gTG9nRW1vamlzLkVSUk9SO1xyXG4gICAgICAgIGxldmVsID0gJ2Vycm9yJztcclxuICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSB0aHJlc2hvbGQud2FybmluZykge1xyXG4gICAgICAgIGVtb2ppID0gTG9nRW1vamlzLldBUk5JTkc7XHJcbiAgICAgICAgbGV2ZWwgPSAnd2Fybic7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZW1vamkgPSBMb2dFbW9qaXMuU1VDQ0VTUztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBgUGVyZm9ybWFuY2UgbWV0cmljOiAke21ldHJpY30gPSAke3ZhbHVlfSR7dW5pdH1gO1xyXG4gICAgXHJcbiAgICBjb25zdCBlbnJpY2hlZE1ldGE6IExvZ01ldGFkYXRhID0ge1xyXG4gICAgICAuLi5tZXRhLFxyXG4gICAgICBtZXRyaWMsXHJcbiAgICAgIHZhbHVlLFxyXG4gICAgICB1bml0LFxyXG4gICAgICB0aHJlc2hvbGQsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMubG9nV2l0aEVtb2ppKGxldmVsLCBlbW9qaSwgbWVzc2FnZSwgZW5yaWNoZWRNZXRhKTtcclxuICAgIHRoaXMucGVyZm9ybWFuY2VNZXRyaWNzLnNldChtZXRyaWMsIHZhbHVlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBuZXR3b3JrIGNvbm5lY3Rpdml0eSBzdGF0dXNcclxuICAgKi9cclxuICBwdWJsaWMgbG9nQ29ubmVjdGl2aXR5KFxyXG4gICAgc2VydmljZTogc3RyaW5nLFxyXG4gICAgc3RhdHVzOiAnQ09OTkVDVEVEJyB8ICdESVNDT05ORUNURUQnIHwgJ1JFQ09OTkVDVElORycgfCAnVElNRU9VVCcsXHJcbiAgICBsYXRlbmN5PzogbnVtYmVyLFxyXG4gICAgbWV0YT86IExvZ01ldGFkYXRhXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBzdGF0dXNFbW9qaXMgPSB7XHJcbiAgICAgIENPTk5FQ1RFRDogTG9nRW1vamlzLkNPTk5FQ1RFRCxcclxuICAgICAgRElTQ09OTkVDVEVEOiBMb2dFbW9qaXMuRElTQ09OTkVDVEVELFxyXG4gICAgICBSRUNPTk5FQ1RJTkc6IExvZ0Vtb2ppcy5SRVNUQVJULFxyXG4gICAgICBUSU1FT1VUOiBMb2dFbW9qaXMuV0FSTklOR1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBlbW9qaSA9IHN0YXR1c0Vtb2ppc1tzdGF0dXNdO1xyXG4gICAgbGV0IG1lc3NhZ2UgPSBgJHtzZXJ2aWNlfSAke3N0YXR1cy50b0xvd2VyQ2FzZSgpfWA7XHJcbiAgICBcclxuICAgIGlmIChsYXRlbmN5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgY29uc3QgbGF0ZW5jeUVtb2ppID0gbGF0ZW5jeSA8IDEwMCA/IExvZ0Vtb2ppcy5GQVNUIDogXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZW5jeSA8IDUwMCA/IExvZ0Vtb2ppcy5JTkZPIDogTG9nRW1vamlzLlNMT1c7XHJcbiAgICAgIG1lc3NhZ2UgKz0gYCAke2xhdGVuY3lFbW9qaX0gKCR7bGF0ZW5jeX1tcylgO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGVucmljaGVkTWV0YTogTG9nTWV0YWRhdGEgPSB7XHJcbiAgICAgIC4uLm1ldGEsXHJcbiAgICAgIHNlcnZpY2UsXHJcbiAgICAgIHN0YXR1czogc3RhdHVzLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIGxhdGVuY3ksXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGxldmVsID0gc3RhdHVzID09PSAnRElTQ09OTkVDVEVEJyB8fCBzdGF0dXMgPT09ICdUSU1FT1VUJyA/ICd3YXJuJyA6ICdpbmZvJztcclxuICAgIHRoaXMubG9nV2l0aEVtb2ppKGxldmVsLCBlbW9qaSwgbWVzc2FnZSwgZW5yaWNoZWRNZXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBtYXJrZXQgc2VudGltZW50IGFuZCBhbmFseXNpc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2dNYXJrZXRTZW50aW1lbnQoXHJcbiAgICBzeW1ib2w6IHN0cmluZyxcclxuICAgIHNlbnRpbWVudDogJ0JVTExJU0gnIHwgJ0JFQVJJU0gnIHwgJ05FVVRSQUwnLFxyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyLFxyXG4gICAgaW5kaWNhdG9ycz86IFJlY29yZDxzdHJpbmcsIGFueT4sXHJcbiAgICBtZXRhPzogTG9nTWV0YWRhdGFcclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHNlbnRpbWVudEVtb2ppcyA9IHtcclxuICAgICAgQlVMTElTSDogTG9nRW1vamlzLkJVTEwsXHJcbiAgICAgIEJFQVJJU0g6IExvZ0Vtb2ppcy5CRUFSLFxyXG4gICAgICBORVVUUkFMOiBMb2dFbW9qaXMuQkFMQU5DRVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBlbW9qaSA9IHNlbnRpbWVudEVtb2ppc1tzZW50aW1lbnRdO1xyXG4gICAgY29uc3QgbWVzc2FnZSA9IGBNYXJrZXQgc2VudGltZW50IGZvciAke3N5bWJvbH06ICR7c2VudGltZW50fSAoJHsoY29uZmlkZW5jZSAqIDEwMCkudG9GaXhlZCgxKX0lIGNvbmZpZGVuY2UpYDtcclxuICAgIFxyXG4gICAgY29uc3QgZW5yaWNoZWRNZXRhOiBMb2dNZXRhZGF0YSA9IHtcclxuICAgICAgLi4ubWV0YSxcclxuICAgICAgc3ltYm9sLFxyXG4gICAgICBzZW50aW1lbnQ6IHNlbnRpbWVudC50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICBjb25maWRlbmNlLFxyXG4gICAgICBpbmRpY2F0b3JzLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnRyYWRpbmcoJ21hcmtldF9hbmFseXNpcycsIGAke2Vtb2ppfSAke21lc3NhZ2V9YCwgZW5yaWNoZWRNZXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBub3RpZmljYXRpb24gZGVsaXZlcnkgc3RhdHVzXHJcbiAgICovXHJcbiAgcHVibGljIGxvZ05vdGlmaWNhdGlvbihcclxuICAgIGNoYW5uZWw6ICdURUxFR1JBTScgfCAnRU1BSUwnIHwgJ1dFQkhPT0snLFxyXG4gICAgc3RhdHVzOiAnU0VOVCcgfCAnRkFJTEVEJyB8ICdRVUVVRUQnLFxyXG4gICAgcmVjaXBpZW50Pzogc3RyaW5nLFxyXG4gICAgbWV0YT86IExvZ01ldGFkYXRhXHJcbiAgKTogdm9pZCB7XHJcbiAgICBjb25zdCBjaGFubmVsRW1vamlzID0ge1xyXG4gICAgICBURUxFR1JBTTogTG9nRW1vamlzLlRFTEVHUkFNLFxyXG4gICAgICBFTUFJTDogTG9nRW1vamlzLkVNQUlMLFxyXG4gICAgICBXRUJIT09LOiBMb2dFbW9qaXMuQVBJXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHN0YXR1c0Vtb2ppcyA9IHtcclxuICAgICAgU0VOVDogTG9nRW1vamlzLlNVQ0NFU1MsXHJcbiAgICAgIEZBSUxFRDogTG9nRW1vamlzLkVSUk9SLFxyXG4gICAgICBRVUVVRUQ6IExvZ0Vtb2ppcy5JTkZPXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGNoYW5uZWxFbW9qaSA9IGNoYW5uZWxFbW9qaXNbY2hhbm5lbF07XHJcbiAgICBjb25zdCBzdGF0dXNFbW9qaSA9IHN0YXR1c0Vtb2ppc1tzdGF0dXNdO1xyXG4gICAgXHJcbiAgICBsZXQgbWVzc2FnZSA9IGAke2NoYW5uZWxFbW9qaX0gJHtjaGFubmVsfSBub3RpZmljYXRpb24gJHtzdGF0dXMudG9Mb3dlckNhc2UoKX1gO1xyXG4gICAgaWYgKHJlY2lwaWVudCkge1xyXG4gICAgICBtZXNzYWdlICs9IGAgdG8gJHtyZWNpcGllbnR9YDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlbnJpY2hlZE1ldGE6IExvZ01ldGFkYXRhID0ge1xyXG4gICAgICAuLi5tZXRhLFxyXG4gICAgICBjaGFubmVsOiBjaGFubmVsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHN0YXR1czogc3RhdHVzLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHJlY2lwaWVudCxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbGV2ZWwgPSBzdGF0dXMgPT09ICdGQUlMRUQnID8gJ2Vycm9yJyA6ICdpbmZvJztcclxuICAgIHRoaXMubG9nV2l0aEVtb2ppKGxldmVsLCBzdGF0dXNFbW9qaSwgbWVzc2FnZSwgZW5yaWNoZWRNZXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBzZWN1cml0eSBldmVudHMgd2l0aCBhcHByb3ByaWF0ZSBjbGFzc2lmaWNhdGlvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2dTZWN1cml0eUV2ZW50KFxyXG4gICAgZXZlbnRUeXBlOiAnTE9HSU4nIHwgJ0xPR09VVCcgfCAnQVBJX0FDQ0VTUycgfCAnVU5BVVRIT1JJWkVEJyB8ICdTVVNQSUNJT1VTJyxcclxuICAgIHNldmVyaXR5OiAnTE9XJyB8ICdNRURJVU0nIHwgJ0hJR0gnIHwgJ0NSSVRJQ0FMJyxcclxuICAgIGRldGFpbHM6IHN0cmluZyxcclxuICAgIG1ldGE/OiBMb2dNZXRhZGF0YVxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2V2ZXJpdHlFbW9qaXMgPSB7XHJcbiAgICAgIExPVzogTG9nRW1vamlzLklORk8sXHJcbiAgICAgIE1FRElVTTogTG9nRW1vamlzLldBUk5JTkcsXHJcbiAgICAgIEhJR0g6IExvZ0Vtb2ppcy5BTEVSVCxcclxuICAgICAgQ1JJVElDQUw6IExvZ0Vtb2ppcy5FUlJPUlxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBlbW9qaSA9IHNldmVyaXR5RW1vamlzW3NldmVyaXR5XTtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHtMb2dFbW9qaXMuU0VDVVJJVFl9IFNlY3VyaXR5IGV2ZW50OiAke2V2ZW50VHlwZX0gLSAke2RldGFpbHN9YDtcclxuICAgIFxyXG4gICAgY29uc3QgZW5yaWNoZWRNZXRhOiBMb2dNZXRhZGF0YSA9IHtcclxuICAgICAgLi4ubWV0YSxcclxuICAgICAgZXZlbnRUeXBlOiBldmVudFR5cGUudG9Mb3dlckNhc2UoKSxcclxuICAgICAgc2V2ZXJpdHk6IHNldmVyaXR5LnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIGNsYXNzaWZpY2F0aW9uOiAnQ09ORklERU5USUFMJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbGV2ZWwgPSBzZXZlcml0eSA9PT0gJ0NSSVRJQ0FMJyB8fCBzZXZlcml0eSA9PT0gJ0hJR0gnID8gJ2Vycm9yJyA6IFxyXG4gICAgICAgICAgICAgICAgIHNldmVyaXR5ID09PSAnTUVESVVNJyA/ICd3YXJuJyA6ICdpbmZvJztcclxuICAgIFxyXG4gICAgdGhpcy5zZWN1cml0eShldmVudFR5cGUudG9Mb3dlckNhc2UoKSwgYCR7ZW1vaml9ICR7bWVzc2FnZX1gLCBlbnJpY2hlZE1ldGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGEgcHJvZ3Jlc3MgaW5kaWNhdG9yIGZvciBsb25nLXJ1bm5pbmcgb3BlcmF0aW9uc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2dQcm9ncmVzcyhcclxuICAgIG9wZXJhdGlvbjogc3RyaW5nLFxyXG4gICAgY3VycmVudDogbnVtYmVyLFxyXG4gICAgdG90YWw6IG51bWJlcixcclxuICAgIG1ldGE/OiBMb2dNZXRhZGF0YVxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGN1cnJlbnQgLyB0b3RhbCkgKiAxMDApO1xyXG4gICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSB0aGlzLmNyZWF0ZVByb2dyZXNzQmFyKHBlcmNlbnRhZ2UpO1xyXG4gICAgY29uc3QgZW1vamkgPSBwZXJjZW50YWdlID09PSAxMDAgPyBMb2dFbW9qaXMuU1VDQ0VTUyA6IExvZ0Vtb2ppcy5JTkZPO1xyXG4gICAgXHJcbiAgICBjb25zdCBtZXNzYWdlID0gYCR7b3BlcmF0aW9ufSBwcm9ncmVzczogJHtwcm9ncmVzc0Jhcn0gJHtwZXJjZW50YWdlfSUgKCR7Y3VycmVudH0vJHt0b3RhbH0pYDtcclxuICAgIFxyXG4gICAgY29uc3QgZW5yaWNoZWRNZXRhOiBMb2dNZXRhZGF0YSA9IHtcclxuICAgICAgLi4ubWV0YSxcclxuICAgICAgb3BlcmF0aW9uLFxyXG4gICAgICBjdXJyZW50LFxyXG4gICAgICB0b3RhbCxcclxuICAgICAgcGVyY2VudGFnZSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5sb2dXaXRoRW1vamkoJ2luZm8nLCBlbW9qaSwgbWVzc2FnZSwgZW5yaWNoZWRNZXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBhIHZpc3VhbCBwcm9ncmVzcyBiYXJcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZVByb2dyZXNzQmFyKHBlcmNlbnRhZ2U6IG51bWJlciwgd2lkdGg6IG51bWJlciA9IDIwKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGZpbGxlZCA9IE1hdGgucm91bmQoKHBlcmNlbnRhZ2UgLyAxMDApICogd2lkdGgpO1xyXG4gICAgY29uc3QgZW1wdHkgPSB3aWR0aCAtIGZpbGxlZDtcclxuICAgIHJldHVybiAn4paIJy5yZXBlYXQoZmlsbGVkKSArICfilpEnLnJlcGVhdChlbXB0eSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmNyZW1lbnQgb3BlcmF0aW9uIGNvdW50ZXJcclxuICAgKi9cclxuICBwcml2YXRlIGluY3JlbWVudENvdW50ZXIob3BlcmF0aW9uOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLm9wZXJhdGlvbkNvdW50ZXJzLmdldChvcGVyYXRpb24pIHx8IDA7XHJcbiAgICB0aGlzLm9wZXJhdGlvbkNvdW50ZXJzLnNldChvcGVyYXRpb24sIGN1cnJlbnQgKyAxKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBjdXJyZW50IHBlcmZvcm1hbmNlIG1ldHJpY3NcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0UGVyZm9ybWFuY2VNZXRyaWNzKCk6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4ge1xyXG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyh0aGlzLnBlcmZvcm1hbmNlTWV0cmljcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgb3BlcmF0aW9uIGNvdW50ZXJzXHJcbiAgICovXHJcbiAgcHVibGljIGdldE9wZXJhdGlvbkNvdW50ZXJzKCk6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4ge1xyXG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyh0aGlzLm9wZXJhdGlvbkNvdW50ZXJzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IGFsbCBjb3VudGVycyBhbmQgbWV0cmljc1xyXG4gICAqL1xyXG4gIHB1YmxpYyByZXNldE1ldHJpY3MoKTogdm9pZCB7XHJcbiAgICB0aGlzLnBlcmZvcm1hbmNlTWV0cmljcy5jbGVhcigpO1xyXG4gICAgdGhpcy5vcGVyYXRpb25Db3VudGVycy5jbGVhcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgYSBzdW1tYXJ5IHJlcG9ydCBvZiBsb2dnaW5nIGFjdGl2aXR5XHJcbiAgICovXHJcbiAgcHVibGljIGdlbmVyYXRlTG9nU3VtbWFyeSgpOiB7XHJcbiAgICBtZXRyaWNzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xyXG4gICAgY291bnRlcnM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgICB0aW1lc3RhbXA6IHN0cmluZztcclxuICB9IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG1ldHJpY3M6IHRoaXMuZ2V0UGVyZm9ybWFuY2VNZXRyaWNzKCksXHJcbiAgICAgIGNvdW50ZXJzOiB0aGlzLmdldE9wZXJhdGlvbkNvdW50ZXJzKCksXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gQ3JlYXRlIGFuZCBleHBvcnQgZW5oYW5jZWQgbG9nZ2VyIGluc3RhbmNlXHJcbmV4cG9ydCBjb25zdCBlbmhhbmNlZExvZ2dlciA9IG5ldyBFbmhhbmNlZExvZ2dlcigpO1xyXG5cclxuLy8gRXhwb3J0IHR5cGVzIGFuZCBjb25zdGFudHNcclxuZXhwb3J0IHR5cGUgeyBMb2dNZXRhZGF0YSB9O1xyXG5leHBvcnQgeyBMb2dFbW9qaXMsIExvZ0NvbG9ycyB9OyJdLCJ2ZXJzaW9uIjozfQ==