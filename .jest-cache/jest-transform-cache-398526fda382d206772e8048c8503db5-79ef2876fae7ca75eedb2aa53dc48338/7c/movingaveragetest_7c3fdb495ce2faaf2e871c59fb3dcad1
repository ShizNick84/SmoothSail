656de45bff4bc05122909f786f6591f9
"use strict";
/**
 * Unit Tests for Moving Average Strategy
 *
 * Comprehensive test suite covering all functionality of the MovingAverageStrategy class
 * including SMA/EMA calculations, crossover detection, signal generation, and edge cases.
 *
 * Requirements: 17.1, 17.3, 17.6 - Unit tests for technical indicators
 */
Object.defineProperty(exports, "__esModule", { value: true });
const moving_average_1 = require("../moving-average");
describe('MovingAverageStrategy', () => {
    let strategy;
    let mockMarketData;
    beforeEach(() => {
        strategy = new moving_average_1.MovingAverageStrategy();
        // Create realistic mock market data for testing
        mockMarketData = [
            { symbol: 'BTC/USDT', timestamp: new Date('2024-01-01'), open: 42000, high: 42500, low: 41500, close: 42200, volume: 1000 },
            { symbol: 'BTC/USDT', timestamp: new Date('2024-01-02'), open: 42200, high: 42800, low: 42000, close: 42600, volume: 1200 },
            { symbol: 'BTC/USDT', timestamp: new Date('2024-01-03'), open: 42600, high: 43000, low: 42400, close: 42800, volume: 1100 },
            { symbol: 'BTC/USDT', timestamp: new Date('2024-01-04'), open: 42800, high: 43200, low: 42600, close: 43000, volume: 1300 },
            { symbol: 'BTC/USDT', timestamp: new Date('2024-01-05'), open: 43000, high: 43400, low: 42800, close: 43200, volume: 1400 },
        ];
    });
    describe('calculateSMA', () => {
        it('should calculate Simple Moving Average correctly', () => {
            const prices = [10, 12, 14, 16, 18];
            const result = strategy.calculateSMA(prices, 3);
            // SMA of last 3 prices: (14 + 16 + 18) / 3 = 16
            expect(result).toBe(16);
        });
        it('should return null for insufficient data', () => {
            const prices = [10, 12];
            const result = strategy.calculateSMA(prices, 5);
            expect(result).toBeNull();
        });
        it('should handle single period correctly', () => {
            const prices = [100];
            const result = strategy.calculateSMA(prices, 1);
            expect(result).toBe(100);
        });
        it('should handle empty array', () => {
            const prices = [];
            const result = strategy.calculateSMA(prices, 3);
            expect(result).toBeNull();
        });
        it('should calculate SMA for exact period length', () => {
            const prices = [10, 20, 30];
            const result = strategy.calculateSMA(prices, 3);
            expect(result).toBe(20);
        });
    });
    describe('calculateEMA', () => {
        it('should calculate Exponential Moving Average correctly', () => {
            const prices = [10, 12, 14, 16, 18];
            const result = strategy.calculateEMA(prices, 3);
            // EMA calculation with multiplier 2/(3+1) = 0.5
            // Starting with first price: 10
            // EMA = (12 * 0.5) + (10 * 0.5) = 11
            // EMA = (14 * 0.5) + (11 * 0.5) = 12.5
            // EMA = (16 * 0.5) + (12.5 * 0.5) = 14.25
            // EMA = (18 * 0.5) + (14.25 * 0.5) = 16.125
            expect(result).toBeCloseTo(16.125, 3);
        });
        it('should return null for insufficient data', () => {
            const prices = [10, 12];
            const result = strategy.calculateEMA(prices, 5);
            expect(result).toBeNull();
        });
        it('should handle single price correctly', () => {
            const prices = [100];
            const result = strategy.calculateEMA(prices, 1);
            expect(result).toBe(100);
        });
        it('should be more responsive than SMA to recent price changes', () => {
            const prices = [10, 10, 10, 10, 20]; // Sharp increase at end
            const sma = strategy.calculateSMA(prices, 5);
            const ema = strategy.calculateEMA(prices, 5);
            expect(ema).toBeGreaterThan(sma);
        });
    });
    describe('calculateEMACrossover', () => {
        it('should calculate both fast and slow EMAs', () => {
            const result = strategy.calculateEMACrossover(mockMarketData, 2, 3);
            expect(result.fastEMA).toBeDefined();
            expect(result.slowEMA).toBeDefined();
            expect(typeof result.fastEMA).toBe('number');
            expect(typeof result.slowEMA).toBe('number');
        });
        it('should return null for insufficient data', () => {
            const shortData = mockMarketData.slice(0, 2);
            const result = strategy.calculateEMACrossover(shortData, 5, 10);
            expect(result.fastEMA).toBeNull();
            expect(result.slowEMA).toBeNull();
        });
        it('should use default periods when not specified', () => {
            const result = strategy.calculateEMACrossover(mockMarketData);
            // Should not be null even with default periods if we have enough data
            // But our mock data is too short for default periods (20, 50)
            expect(result.fastEMA).toBeNull();
            expect(result.slowEMA).toBeNull();
        });
    });
    describe('detectCrossover', () => {
        let extendedMarketData;
        beforeEach(() => {
            // Create extended data for crossover testing
            extendedMarketData = [];
            for (let i = 0; i < 60; i++) {
                extendedMarketData.push({
                    symbol: 'BTC/USDT',
                    timestamp: new Date(2024, 0, i + 1),
                    open: 42000 + i * 10,
                    high: 42500 + i * 10,
                    low: 41500 + i * 10,
                    close: 42000 + i * 10 + (i > 30 ? 100 : 0), // Price jump after day 30
                    volume: 1000 + Math.random() * 500
                });
            }
        });
        it('should detect golden cross (bullish crossover)', () => {
            // Modify data to create a clear golden cross
            const testData = [...extendedMarketData];
            // Create scenario where fast EMA crosses above slow EMA
            for (let i = 50; i < testData.length; i++) {
                testData[i].close = testData[i].close + (i - 49) * 50; // Sharp uptrend
            }
            const result = strategy.detectCrossover(testData, 5, 10);
            expect(result).toBeDefined();
            if (result?.crossover) {
                expect(['GOLDEN_CROSS', 'NONE']).toContain(result.crossover.type);
            }
        });
        it('should detect death cross (bearish crossover)', () => {
            // Modify data to create a clear death cross
            const testData = [...extendedMarketData];
            // Create scenario where fast EMA crosses below slow EMA
            for (let i = 50; i < testData.length; i++) {
                testData[i].close = testData[i].close - (i - 49) * 50; // Sharp downtrend
            }
            const result = strategy.detectCrossover(testData, 5, 10);
            expect(result).toBeDefined();
            if (result?.crossover) {
                expect(['DEATH_CROSS', 'NONE']).toContain(result.crossover.type);
            }
        });
        it('should return null for insufficient data', () => {
            const result = strategy.detectCrossover(mockMarketData, 20, 50);
            expect(result).toBeNull();
        });
        it('should include volume confirmation in result', () => {
            const result = strategy.detectCrossover(extendedMarketData, 5, 10);
            if (result?.crossover) {
                expect(typeof result.crossover.volumeConfirmed).toBe('boolean');
            }
        });
    });
    describe('generateSignal', () => {
        let extendedMarketData;
        beforeEach(() => {
            // Create data that will generate a signal
            extendedMarketData = [];
            for (let i = 0; i < 30; i++) {
                extendedMarketData.push({
                    symbol: 'BTC/USDT',
                    timestamp: new Date(2024, 0, i + 1),
                    open: 42000,
                    high: 42500,
                    low: 41500,
                    close: 42000 + (i > 15 ? i * 20 : 0), // Uptrend after day 15
                    volume: 1000 + Math.random() * 500
                });
            }
        });
        it('should generate BUY signal for golden cross', () => {
            // Create strong uptrend for golden cross
            const testData = [...extendedMarketData];
            for (let i = 20; i < testData.length; i++) {
                testData[i].close = testData[i].close + (i - 19) * 100;
                testData[i].volume = 2000; // High volume
            }
            const result = strategy.generateSignal(testData, 3, 7);
            if (result) {
                expect(result.type).toBe('BUY');
                expect(result.symbol).toBe('BTC/USDT');
                expect(result.strength).toBeGreaterThan(0);
                expect(result.confidence).toBeGreaterThan(0);
                expect(result.indicators).toContain('EMA_3');
                expect(result.indicators).toContain('EMA_7');
                expect(result.reasoning).toContain('Golden Cross');
            }
        });
        it('should generate SELL signal for death cross', () => {
            // Create strong downtrend for death cross
            const testData = [...extendedMarketData];
            for (let i = 20; i < testData.length; i++) {
                testData[i].close = testData[i].close - (i - 19) * 100;
                testData[i].volume = 2000; // High volume
            }
            const result = strategy.generateSignal(testData, 3, 7);
            if (result) {
                expect(result.type).toBe('SELL');
                expect(result.reasoning).toContain('Death Cross');
            }
        });
        it('should return null when no crossover detected', () => {
            // Flat market data
            const flatData = extendedMarketData.map(data => ({
                ...data,
                close: 42000 // Constant price
            }));
            const result = strategy.generateSignal(flatData, 3, 7);
            expect(result).toBeNull();
        });
        it('should include proper metadata in signal', () => {
            const testData = [...extendedMarketData];
            for (let i = 20; i < testData.length; i++) {
                testData[i].close = testData[i].close + (i - 19) * 50;
            }
            const result = strategy.generateSignal(testData, 3, 7);
            if (result) {
                expect(result.metadata).toBeDefined();
                expect(result.metadata?.fastEMA).toBeDefined();
                expect(result.metadata?.slowEMA).toBeDefined();
                expect(result.metadata?.volumeConfirmed).toBeDefined();
                expect(result.metadata?.crossoverType).toBeDefined();
            }
        });
        it('should calculate risk-reward ratio', () => {
            const testData = [...extendedMarketData];
            for (let i = 20; i < testData.length; i++) {
                testData[i].close = testData[i].close + (i - 19) * 50;
            }
            const result = strategy.generateSignal(testData, 3, 7);
            if (result) {
                expect(result.riskReward).toBeGreaterThan(0);
                expect(typeof result.riskReward).toBe('number');
            }
        });
    });
    describe('evaluateSignalConfidence', () => {
        let mockSignal;
        beforeEach(() => {
            mockSignal = {
                id: 'test-signal',
                symbol: 'BTC/USDT',
                type: 'BUY',
                strength: 75,
                confidence: 80,
                indicators: ['EMA_20', 'EMA_50'],
                reasoning: 'Test signal',
                riskReward: 1.5,
                timestamp: new Date(),
                metadata: {
                    volumeConfirmed: true
                }
            };
        });
        it('should evaluate signal confidence correctly', () => {
            const result = strategy.evaluateSignalConfidence(mockMarketData, mockSignal);
            expect(result.overall).toBeGreaterThan(0);
            expect(result.overall).toBeLessThanOrEqual(100);
            expect(result.technical).toBe(75); // From signal strength
            expect(result.volume).toBe(80); // High due to volume confirmation
            expect(result.momentum).toBeGreaterThan(0);
            expect(result.factors).toHaveLength(3);
        });
        it('should penalize signals without volume confirmation', () => {
            mockSignal.metadata = { volumeConfirmed: false };
            const result = strategy.evaluateSignalConfidence(mockMarketData, mockSignal);
            expect(result.volume).toBe(40); // Lower due to no volume confirmation
        });
        it('should include descriptive factors', () => {
            const result = strategy.evaluateSignalConfidence(mockMarketData, mockSignal);
            expect(result.factors[0]).toContain('EMA crossover strength');
            expect(result.factors[1]).toContain('Volume confirmation');
            expect(result.factors[2]).toContain('Price momentum');
        });
    });
    describe('Edge Cases and Error Handling', () => {
        it('should handle zero prices gracefully', () => {
            const zeroPrices = [0, 0, 0, 0, 0];
            const smaResult = strategy.calculateSMA(zeroPrices, 3);
            const emaResult = strategy.calculateEMA(zeroPrices, 3);
            expect(smaResult).toBe(0);
            expect(emaResult).toBe(0);
        });
        it('should handle negative prices', () => {
            const negativePrices = [-10, -5, 0, 5, 10];
            const smaResult = strategy.calculateSMA(negativePrices, 5);
            const emaResult = strategy.calculateEMA(negativePrices, 5);
            expect(smaResult).toBe(0); // Average of -10 to 10
            expect(emaResult).toBeDefined();
        });
        it('should handle very large numbers', () => {
            const largePrices = [1e10, 1e10 + 1, 1e10 + 2, 1e10 + 3, 1e10 + 4];
            const result = strategy.calculateSMA(largePrices, 3);
            expect(result).toBeCloseTo(1e10 + 3, -8); // Should handle precision
        });
        it('should handle market data with missing volume', () => {
            const dataWithoutVolume = mockMarketData.map(data => ({
                ...data,
                volume: 0
            }));
            const result = strategy.generateSignal(dataWithoutVolume, 2, 3);
            // Should not crash, may return null or signal without volume confirmation
            expect(result === null || typeof result === 'object').toBe(true);
        });
        it('should handle identical consecutive prices', () => {
            const flatPrices = [100, 100, 100, 100, 100];
            const smaResult = strategy.calculateSMA(flatPrices, 3);
            const emaResult = strategy.calculateEMA(flatPrices, 3);
            expect(smaResult).toBe(100);
            expect(emaResult).toBe(100);
        });
    });
    describe('Performance and Optimization', () => {
        it('should handle large datasets efficiently', () => {
            // Create large dataset
            const largeDataset = [];
            for (let i = 0; i < 1000; i++) {
                largeDataset.push({
                    symbol: 'BTC/USDT',
                    timestamp: new Date(2024, 0, i + 1),
                    open: 42000 + Math.random() * 1000,
                    high: 42500 + Math.random() * 1000,
                    low: 41500 + Math.random() * 1000,
                    close: 42000 + Math.random() * 1000,
                    volume: 1000 + Math.random() * 500
                });
            }
            const startTime = Date.now();
            const result = strategy.generateSignal(largeDataset, 20, 50);
            const endTime = Date.now();
            // Should complete within reasonable time (less than 100ms)
            expect(endTime - startTime).toBeLessThan(100);
        });
        it('should not modify input data', () => {
            const originalData = [...mockMarketData];
            strategy.generateSignal(mockMarketData, 2, 3);
            expect(mockMarketData).toEqual(originalData);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxOaWNrXFxEZXNrdG9wXFxTbW9vdGhTYWlsXFxzcmNcXHRyYWRpbmdcXHN0cmF0ZWdpZXNcXF9fdGVzdHNfX1xcbW92aW5nLWF2ZXJhZ2UudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7QUFFSCxzREFBMEQ7QUFHMUQsUUFBUSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtJQUNyQyxJQUFJLFFBQStCLENBQUM7SUFDcEMsSUFBSSxjQUE0QixDQUFDO0lBRWpDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxRQUFRLEdBQUcsSUFBSSxzQ0FBcUIsRUFBRSxDQUFDO1FBRXZDLGdEQUFnRDtRQUNoRCxjQUFjLEdBQUc7WUFDZixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtZQUMzSCxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtZQUMzSCxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtZQUMzSCxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FB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QUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtZQUN0QyxNQUFNLFlBQVksR0FBRyxDQUFDLEdBQUcsY0FBYyxDQUFDLENBQUM7WUFDekMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRTlDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcTmlja1xcRGVza3RvcFxcU21vb3RoU2FpbFxcc3JjXFx0cmFkaW5nXFxzdHJhdGVnaWVzXFxfX3Rlc3RzX19cXG1vdmluZy1hdmVyYWdlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFVuaXQgVGVzdHMgZm9yIE1vdmluZyBBdmVyYWdlIFN0cmF0ZWd5XHJcbiAqIFxyXG4gKiBDb21wcmVoZW5zaXZlIHRlc3Qgc3VpdGUgY292ZXJpbmcgYWxsIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIE1vdmluZ0F2ZXJhZ2VTdHJhdGVneSBjbGFzc1xyXG4gKiBpbmNsdWRpbmcgU01BL0VNQSBjYWxjdWxhdGlvbnMsIGNyb3Nzb3ZlciBkZXRlY3Rpb24sIHNpZ25hbCBnZW5lcmF0aW9uLCBhbmQgZWRnZSBjYXNlcy5cclxuICogXHJcbiAqIFJlcXVpcmVtZW50czogMTcuMSwgMTcuMywgMTcuNiAtIFVuaXQgdGVzdHMgZm9yIHRlY2huaWNhbCBpbmRpY2F0b3JzXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTW92aW5nQXZlcmFnZVN0cmF0ZWd5IH0gZnJvbSAnLi4vbW92aW5nLWF2ZXJhZ2UnO1xyXG5pbXBvcnQgeyBNYXJrZXREYXRhLCBUcmFkaW5nU2lnbmFsLCBNb3ZpbmdBdmVyYWdlU2lnbmFsIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuZGVzY3JpYmUoJ01vdmluZ0F2ZXJhZ2VTdHJhdGVneScsICgpID0+IHtcclxuICBsZXQgc3RyYXRlZ3k6IE1vdmluZ0F2ZXJhZ2VTdHJhdGVneTtcclxuICBsZXQgbW9ja01hcmtldERhdGE6IE1hcmtldERhdGFbXTtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBzdHJhdGVneSA9IG5ldyBNb3ZpbmdBdmVyYWdlU3RyYXRlZ3koKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIHJlYWxpc3RpYyBtb2NrIG1hcmtldCBkYXRhIGZvciB0ZXN0aW5nXHJcbiAgICBtb2NrTWFya2V0RGF0YSA9IFtcclxuICAgICAgeyBzeW1ib2w6ICdCVEMvVVNEVCcsIHRpbWVzdGFtcDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSwgb3BlbjogNDIwMDAsIGhpZ2g6IDQyNTAwLCBsb3c6IDQxNTAwLCBjbG9zZTogNDIyMDAsIHZvbHVtZTogMTAwMCB9LFxyXG4gICAgICB7IHN5bWJvbDogJ0JUQy9VU0RUJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgnMjAyNC0wMS0wMicpLCBvcGVuOiA0MjIwMCwgaGlnaDogNDI4MDAsIGxvdzogNDIwMDAsIGNsb3NlOiA0MjYwMCwgdm9sdW1lOiAxMjAwIH0sXHJcbiAgICAgIHsgc3ltYm9sOiAnQlRDL1VTRFQnLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCcyMDI0LTAxLTAzJyksIG9wZW46IDQyNjAwLCBoaWdoOiA0MzAwMCwgbG93OiA0MjQwMCwgY2xvc2U6IDQyODAwLCB2b2x1bWU6IDExMDAgfSxcclxuICAgICAgeyBzeW1ib2w6ICdCVEMvVVNEVCcsIHRpbWVzdGFtcDogbmV3IERhdGUoJzIwMjQtMDEtMDQnKSwgb3BlbjogNDI4MDAsIGhpZ2g6IDQzMjAwLCBsb3c6IDQyNjAwLCBjbG9zZTogNDMwMDAsIHZvbHVtZTogMTMwMCB9LFxyXG4gICAgICB7IHN5bWJvbDogJ0JUQy9VU0RUJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgnMjAyNC0wMS0wNScpLCBvcGVuOiA0MzAwMCwgaGlnaDogNDM0MDAsIGxvdzogNDI4MDAsIGNsb3NlOiA0MzIwMCwgdm9sdW1lOiAxNDAwIH0sXHJcbiAgICBdO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnY2FsY3VsYXRlU01BJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgU2ltcGxlIE1vdmluZyBBdmVyYWdlIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3QgcHJpY2VzID0gWzEwLCAxMiwgMTQsIDE2LCAxOF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZVNNQShwcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgLy8gU01BIG9mIGxhc3QgMyBwcmljZXM6ICgxNCArIDE2ICsgMTgpIC8gMyA9IDE2XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoMTYpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCBmb3IgaW5zdWZmaWNpZW50IGRhdGEnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByaWNlcyA9IFsxMCwgMTJdO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVTTUEocHJpY2VzLCA1KTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW5nbGUgcGVyaW9kIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3QgcHJpY2VzID0gWzEwMF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZVNNQShwcmljZXMsIDEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgxMDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByaWNlczogbnVtYmVyW10gPSBbXTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuY2FsY3VsYXRlU01BKHByaWNlcywgMyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgU01BIGZvciBleGFjdCBwZXJpb2QgbGVuZ3RoJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBwcmljZXMgPSBbMTAsIDIwLCAzMF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZVNNQShwcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgyMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NhbGN1bGF0ZUVNQScsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIEV4cG9uZW50aWFsIE1vdmluZyBBdmVyYWdlIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3QgcHJpY2VzID0gWzEwLCAxMiwgMTQsIDE2LCAxOF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZUVNQShwcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgLy8gRU1BIGNhbGN1bGF0aW9uIHdpdGggbXVsdGlwbGllciAyLygzKzEpID0gMC41XHJcbiAgICAgIC8vIFN0YXJ0aW5nIHdpdGggZmlyc3QgcHJpY2U6IDEwXHJcbiAgICAgIC8vIEVNQSA9ICgxMiAqIDAuNSkgKyAoMTAgKiAwLjUpID0gMTFcclxuICAgICAgLy8gRU1BID0gKDE0ICogMC41KSArICgxMSAqIDAuNSkgPSAxMi41XHJcbiAgICAgIC8vIEVNQSA9ICgxNiAqIDAuNSkgKyAoMTIuNSAqIDAuNSkgPSAxNC4yNVxyXG4gICAgICAvLyBFTUEgPSAoMTggKiAwLjUpICsgKDE0LjI1ICogMC41KSA9IDE2LjEyNVxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlQ2xvc2VUbygxNi4xMjUsIDMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCBmb3IgaW5zdWZmaWNpZW50IGRhdGEnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByaWNlcyA9IFsxMCwgMTJdO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVFTUEocHJpY2VzLCA1KTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW5nbGUgcHJpY2UgY29ycmVjdGx5JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBwcmljZXMgPSBbMTAwXTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuY2FsY3VsYXRlRU1BKHByaWNlcywgMSk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKDEwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGJlIG1vcmUgcmVzcG9uc2l2ZSB0aGFuIFNNQSB0byByZWNlbnQgcHJpY2UgY2hhbmdlcycsICgpID0+IHtcclxuICAgICAgY29uc3QgcHJpY2VzID0gWzEwLCAxMCwgMTAsIDEwLCAyMF07IC8vIFNoYXJwIGluY3JlYXNlIGF0IGVuZFxyXG4gICAgICBjb25zdCBzbWEgPSBzdHJhdGVneS5jYWxjdWxhdGVTTUEocHJpY2VzLCA1KTtcclxuICAgICAgY29uc3QgZW1hID0gc3RyYXRlZ3kuY2FsY3VsYXRlRU1BKHByaWNlcywgNSk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoZW1hKS50b0JlR3JlYXRlclRoYW4oc21hISk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NhbGN1bGF0ZUVNQUNyb3Nzb3ZlcicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGJvdGggZmFzdCBhbmQgc2xvdyBFTUFzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVFTUFDcm9zc292ZXIobW9ja01hcmtldERhdGEsIDIsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdC5mYXN0RU1BKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnNsb3dFTUEpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmZhc3RFTUEpLnRvQmUoJ251bWJlcicpO1xyXG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5zbG93RU1BKS50b0JlKCdudW1iZXInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgZm9yIGluc3VmZmljaWVudCBkYXRhJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzaG9ydERhdGEgPSBtb2NrTWFya2V0RGF0YS5zbGljZSgwLCAyKTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuY2FsY3VsYXRlRU1BQ3Jvc3NvdmVyKHNob3J0RGF0YSwgNSwgMTApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdC5mYXN0RU1BKS50b0JlTnVsbCgpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnNsb3dFTUEpLnRvQmVOdWxsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHVzZSBkZWZhdWx0IHBlcmlvZHMgd2hlbiBub3Qgc3BlY2lmaWVkJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVFTUFDcm9zc292ZXIobW9ja01hcmtldERhdGEpO1xyXG4gICAgICBcclxuICAgICAgLy8gU2hvdWxkIG5vdCBiZSBudWxsIGV2ZW4gd2l0aCBkZWZhdWx0IHBlcmlvZHMgaWYgd2UgaGF2ZSBlbm91Z2ggZGF0YVxyXG4gICAgICAvLyBCdXQgb3VyIG1vY2sgZGF0YSBpcyB0b28gc2hvcnQgZm9yIGRlZmF1bHQgcGVyaW9kcyAoMjAsIDUwKVxyXG4gICAgICBleHBlY3QocmVzdWx0LmZhc3RFTUEpLnRvQmVOdWxsKCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc2xvd0VNQSkudG9CZU51bGwoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnZGV0ZWN0Q3Jvc3NvdmVyJywgKCkgPT4ge1xyXG4gICAgbGV0IGV4dGVuZGVkTWFya2V0RGF0YTogTWFya2V0RGF0YVtdO1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAvLyBDcmVhdGUgZXh0ZW5kZWQgZGF0YSBmb3IgY3Jvc3NvdmVyIHRlc3RpbmdcclxuICAgICAgZXh0ZW5kZWRNYXJrZXREYXRhID0gW107XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjA7IGkrKykge1xyXG4gICAgICAgIGV4dGVuZGVkTWFya2V0RGF0YS5wdXNoKHtcclxuICAgICAgICAgIHN5bWJvbDogJ0JUQy9VU0RUJyxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoMjAyNCwgMCwgaSArIDEpLFxyXG4gICAgICAgICAgb3BlbjogNDIwMDAgKyBpICogMTAsXHJcbiAgICAgICAgICBoaWdoOiA0MjUwMCArIGkgKiAxMCxcclxuICAgICAgICAgIGxvdzogNDE1MDAgKyBpICogMTAsXHJcbiAgICAgICAgICBjbG9zZTogNDIwMDAgKyBpICogMTAgKyAoaSA+IDMwID8gMTAwIDogMCksIC8vIFByaWNlIGp1bXAgYWZ0ZXIgZGF5IDMwXHJcbiAgICAgICAgICB2b2x1bWU6IDEwMDAgKyBNYXRoLnJhbmRvbSgpICogNTAwXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGdvbGRlbiBjcm9zcyAoYnVsbGlzaCBjcm9zc292ZXIpJywgKCkgPT4ge1xyXG4gICAgICAvLyBNb2RpZnkgZGF0YSB0byBjcmVhdGUgYSBjbGVhciBnb2xkZW4gY3Jvc3NcclxuICAgICAgY29uc3QgdGVzdERhdGEgPSBbLi4uZXh0ZW5kZWRNYXJrZXREYXRhXTtcclxuICAgICAgLy8gQ3JlYXRlIHNjZW5hcmlvIHdoZXJlIGZhc3QgRU1BIGNyb3NzZXMgYWJvdmUgc2xvdyBFTUFcclxuICAgICAgZm9yIChsZXQgaSA9IDUwOyBpIDwgdGVzdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0ZXN0RGF0YVtpXS5jbG9zZSA9IHRlc3REYXRhW2ldLmNsb3NlICsgKGkgLSA0OSkgKiA1MDsgLy8gU2hhcnAgdXB0cmVuZFxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5kZXRlY3RDcm9zc292ZXIodGVzdERhdGEsIDUsIDEwKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGlmIChyZXN1bHQ/LmNyb3Nzb3Zlcikge1xyXG4gICAgICAgIGV4cGVjdChbJ0dPTERFTl9DUk9TUycsICdOT05FJ10pLnRvQ29udGFpbihyZXN1bHQuY3Jvc3NvdmVyLnR5cGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBkZWF0aCBjcm9zcyAoYmVhcmlzaCBjcm9zc292ZXIpJywgKCkgPT4ge1xyXG4gICAgICAvLyBNb2RpZnkgZGF0YSB0byBjcmVhdGUgYSBjbGVhciBkZWF0aCBjcm9zc1xyXG4gICAgICBjb25zdCB0ZXN0RGF0YSA9IFsuLi5leHRlbmRlZE1hcmtldERhdGFdO1xyXG4gICAgICAvLyBDcmVhdGUgc2NlbmFyaW8gd2hlcmUgZmFzdCBFTUEgY3Jvc3NlcyBiZWxvdyBzbG93IEVNQVxyXG4gICAgICBmb3IgKGxldCBpID0gNTA7IGkgPCB0ZXN0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHRlc3REYXRhW2ldLmNsb3NlID0gdGVzdERhdGFbaV0uY2xvc2UgLSAoaSAtIDQ5KSAqIDUwOyAvLyBTaGFycCBkb3dudHJlbmRcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZGV0ZWN0Q3Jvc3NvdmVyKHRlc3REYXRhLCA1LCAxMCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBpZiAocmVzdWx0Py5jcm9zc292ZXIpIHtcclxuICAgICAgICBleHBlY3QoWydERUFUSF9DUk9TUycsICdOT05FJ10pLnRvQ29udGFpbihyZXN1bHQuY3Jvc3NvdmVyLnR5cGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIGZvciBpbnN1ZmZpY2llbnQgZGF0YScsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZGV0ZWN0Q3Jvc3NvdmVyKG1vY2tNYXJrZXREYXRhLCAyMCwgNTApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB2b2x1bWUgY29uZmlybWF0aW9uIGluIHJlc3VsdCcsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZGV0ZWN0Q3Jvc3NvdmVyKGV4dGVuZGVkTWFya2V0RGF0YSwgNSwgMTApO1xyXG4gICAgICBcclxuICAgICAgaWYgKHJlc3VsdD8uY3Jvc3NvdmVyKSB7XHJcbiAgICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuY3Jvc3NvdmVyLnZvbHVtZUNvbmZpcm1lZCkudG9CZSgnYm9vbGVhbicpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2dlbmVyYXRlU2lnbmFsJywgKCkgPT4ge1xyXG4gICAgbGV0IGV4dGVuZGVkTWFya2V0RGF0YTogTWFya2V0RGF0YVtdO1xyXG5cclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAvLyBDcmVhdGUgZGF0YSB0aGF0IHdpbGwgZ2VuZXJhdGUgYSBzaWduYWxcclxuICAgICAgZXh0ZW5kZWRNYXJrZXREYXRhID0gW107XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzA7IGkrKykge1xyXG4gICAgICAgIGV4dGVuZGVkTWFya2V0RGF0YS5wdXNoKHtcclxuICAgICAgICAgIHN5bWJvbDogJ0JUQy9VU0RUJyxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoMjAyNCwgMCwgaSArIDEpLFxyXG4gICAgICAgICAgb3BlbjogNDIwMDAsXHJcbiAgICAgICAgICBoaWdoOiA0MjUwMCxcclxuICAgICAgICAgIGxvdzogNDE1MDAsXHJcbiAgICAgICAgICBjbG9zZTogNDIwMDAgKyAoaSA+IDE1ID8gaSAqIDIwIDogMCksIC8vIFVwdHJlbmQgYWZ0ZXIgZGF5IDE1XHJcbiAgICAgICAgICB2b2x1bWU6IDEwMDAgKyBNYXRoLnJhbmRvbSgpICogNTAwXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgQlVZIHNpZ25hbCBmb3IgZ29sZGVuIGNyb3NzJywgKCkgPT4ge1xyXG4gICAgICAvLyBDcmVhdGUgc3Ryb25nIHVwdHJlbmQgZm9yIGdvbGRlbiBjcm9zc1xyXG4gICAgICBjb25zdCB0ZXN0RGF0YSA9IFsuLi5leHRlbmRlZE1hcmtldERhdGFdO1xyXG4gICAgICBmb3IgKGxldCBpID0gMjA7IGkgPCB0ZXN0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHRlc3REYXRhW2ldLmNsb3NlID0gdGVzdERhdGFbaV0uY2xvc2UgKyAoaSAtIDE5KSAqIDEwMDtcclxuICAgICAgICB0ZXN0RGF0YVtpXS52b2x1bWUgPSAyMDAwOyAvLyBIaWdoIHZvbHVtZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5nZW5lcmF0ZVNpZ25hbCh0ZXN0RGF0YSwgMywgNyk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC50eXBlKS50b0JlKCdCVVknKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0LnN5bWJvbCkudG9CZSgnQlRDL1VTRFQnKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0LnN0cmVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pbmRpY2F0b3JzKS50b0NvbnRhaW4oJ0VNQV8zJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pbmRpY2F0b3JzKS50b0NvbnRhaW4oJ0VNQV83Jyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5yZWFzb25pbmcpLnRvQ29udGFpbignR29sZGVuIENyb3NzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgU0VMTCBzaWduYWwgZm9yIGRlYXRoIGNyb3NzJywgKCkgPT4ge1xyXG4gICAgICAvLyBDcmVhdGUgc3Ryb25nIGRvd250cmVuZCBmb3IgZGVhdGggY3Jvc3NcclxuICAgICAgY29uc3QgdGVzdERhdGEgPSBbLi4uZXh0ZW5kZWRNYXJrZXREYXRhXTtcclxuICAgICAgZm9yIChsZXQgaSA9IDIwOyBpIDwgdGVzdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0ZXN0RGF0YVtpXS5jbG9zZSA9IHRlc3REYXRhW2ldLmNsb3NlIC0gKGkgLSAxOSkgKiAxMDA7XHJcbiAgICAgICAgdGVzdERhdGFbaV0udm9sdW1lID0gMjAwMDsgLy8gSGlnaCB2b2x1bWVcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZ2VuZXJhdGVTaWduYWwodGVzdERhdGEsIDMsIDcpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQudHlwZSkudG9CZSgnU0VMTCcpO1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQucmVhc29uaW5nKS50b0NvbnRhaW4oJ0RlYXRoIENyb3NzJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgd2hlbiBubyBjcm9zc292ZXIgZGV0ZWN0ZWQnLCAoKSA9PiB7XHJcbiAgICAgIC8vIEZsYXQgbWFya2V0IGRhdGFcclxuICAgICAgY29uc3QgZmxhdERhdGEgPSBleHRlbmRlZE1hcmtldERhdGEubWFwKGRhdGEgPT4gKHtcclxuICAgICAgICAuLi5kYXRhLFxyXG4gICAgICAgIGNsb3NlOiA0MjAwMCAvLyBDb25zdGFudCBwcmljZVxyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5nZW5lcmF0ZVNpZ25hbChmbGF0RGF0YSwgMywgNyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIHByb3BlciBtZXRhZGF0YSBpbiBzaWduYWwnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRlc3REYXRhID0gWy4uLmV4dGVuZGVkTWFya2V0RGF0YV07XHJcbiAgICAgIGZvciAobGV0IGkgPSAyMDsgaSA8IHRlc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGVzdERhdGFbaV0uY2xvc2UgPSB0ZXN0RGF0YVtpXS5jbG9zZSArIChpIC0gMTkpICogNTA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmdlbmVyYXRlU2lnbmFsKHRlc3REYXRhLCAzLCA3KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICBleHBlY3QocmVzdWx0Lm1ldGFkYXRhKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQubWV0YWRhdGE/LmZhc3RFTUEpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5tZXRhZGF0YT8uc2xvd0VNQSkudG9CZURlZmluZWQoKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0Lm1ldGFkYXRhPy52b2x1bWVDb25maXJtZWQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5tZXRhZGF0YT8uY3Jvc3NvdmVyVHlwZSkudG9CZURlZmluZWQoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcmlzay1yZXdhcmQgcmF0aW8nLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRlc3REYXRhID0gWy4uLmV4dGVuZGVkTWFya2V0RGF0YV07XHJcbiAgICAgIGZvciAobGV0IGkgPSAyMDsgaSA8IHRlc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGVzdERhdGFbaV0uY2xvc2UgPSB0ZXN0RGF0YVtpXS5jbG9zZSArIChpIC0gMTkpICogNTA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmdlbmVyYXRlU2lnbmFsKHRlc3REYXRhLCAzLCA3KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICBleHBlY3QocmVzdWx0LnJpc2tSZXdhcmQpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5yaXNrUmV3YXJkKS50b0JlKCdudW1iZXInKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdldmFsdWF0ZVNpZ25hbENvbmZpZGVuY2UnLCAoKSA9PiB7XHJcbiAgICBsZXQgbW9ja1NpZ25hbDogVHJhZGluZ1NpZ25hbDtcclxuXHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgbW9ja1NpZ25hbCA9IHtcclxuICAgICAgICBpZDogJ3Rlc3Qtc2lnbmFsJyxcclxuICAgICAgICBzeW1ib2w6ICdCVEMvVVNEVCcsXHJcbiAgICAgICAgdHlwZTogJ0JVWScsXHJcbiAgICAgICAgc3RyZW5ndGg6IDc1LFxyXG4gICAgICAgIGNvbmZpZGVuY2U6IDgwLFxyXG4gICAgICAgIGluZGljYXRvcnM6IFsnRU1BXzIwJywgJ0VNQV81MCddLFxyXG4gICAgICAgIHJlYXNvbmluZzogJ1Rlc3Qgc2lnbmFsJyxcclxuICAgICAgICByaXNrUmV3YXJkOiAxLjUsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICB2b2x1bWVDb25maXJtZWQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGV2YWx1YXRlIHNpZ25hbCBjb25maWRlbmNlIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZXZhbHVhdGVTaWduYWxDb25maWRlbmNlKG1vY2tNYXJrZXREYXRhLCBtb2NrU2lnbmFsKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQub3ZlcmFsbCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QocmVzdWx0Lm92ZXJhbGwpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTAwKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC50ZWNobmljYWwpLnRvQmUoNzUpOyAvLyBGcm9tIHNpZ25hbCBzdHJlbmd0aFxyXG4gICAgICBleHBlY3QocmVzdWx0LnZvbHVtZSkudG9CZSg4MCk7IC8vIEhpZ2ggZHVlIHRvIHZvbHVtZSBjb25maXJtYXRpb25cclxuICAgICAgZXhwZWN0KHJlc3VsdC5tb21lbnR1bSkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QocmVzdWx0LmZhY3RvcnMpLnRvSGF2ZUxlbmd0aCgzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcGVuYWxpemUgc2lnbmFscyB3aXRob3V0IHZvbHVtZSBjb25maXJtYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgIG1vY2tTaWduYWwubWV0YWRhdGEgPSB7IHZvbHVtZUNvbmZpcm1lZDogZmFsc2UgfTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmV2YWx1YXRlU2lnbmFsQ29uZmlkZW5jZShtb2NrTWFya2V0RGF0YSwgbW9ja1NpZ25hbCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0LnZvbHVtZSkudG9CZSg0MCk7IC8vIExvd2VyIGR1ZSB0byBubyB2b2x1bWUgY29uZmlybWF0aW9uXHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgZGVzY3JpcHRpdmUgZmFjdG9ycycsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gc3RyYXRlZ3kuZXZhbHVhdGVTaWduYWxDb25maWRlbmNlKG1vY2tNYXJrZXREYXRhLCBtb2NrU2lnbmFsKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuZmFjdG9yc1swXSkudG9Db250YWluKCdFTUEgY3Jvc3NvdmVyIHN0cmVuZ3RoJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuZmFjdG9yc1sxXSkudG9Db250YWluKCdWb2x1bWUgY29uZmlybWF0aW9uJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuZmFjdG9yc1syXSkudG9Db250YWluKCdQcmljZSBtb21lbnR1bScpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdFZGdlIENhc2VzIGFuZCBFcnJvciBIYW5kbGluZycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHplcm8gcHJpY2VzIGdyYWNlZnVsbHknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHplcm9QcmljZXMgPSBbMCwgMCwgMCwgMCwgMF07XHJcbiAgICAgIGNvbnN0IHNtYVJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZVNNQSh6ZXJvUHJpY2VzLCAzKTtcclxuICAgICAgY29uc3QgZW1hUmVzdWx0ID0gc3RyYXRlZ3kuY2FsY3VsYXRlRU1BKHplcm9QcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHNtYVJlc3VsdCkudG9CZSgwKTtcclxuICAgICAgZXhwZWN0KGVtYVJlc3VsdCkudG9CZSgwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5lZ2F0aXZlIHByaWNlcycsICgpID0+IHtcclxuICAgICAgY29uc3QgbmVnYXRpdmVQcmljZXMgPSBbLTEwLCAtNSwgMCwgNSwgMTBdO1xyXG4gICAgICBjb25zdCBzbWFSZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVTTUEobmVnYXRpdmVQcmljZXMsIDUpO1xyXG4gICAgICBjb25zdCBlbWFSZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVFTUEobmVnYXRpdmVQcmljZXMsIDUpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHNtYVJlc3VsdCkudG9CZSgwKTsgLy8gQXZlcmFnZSBvZiAtMTAgdG8gMTBcclxuICAgICAgZXhwZWN0KGVtYVJlc3VsdCkudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHZlcnkgbGFyZ2UgbnVtYmVycycsICgpID0+IHtcclxuICAgICAgY29uc3QgbGFyZ2VQcmljZXMgPSBbMWUxMCwgMWUxMCArIDEsIDFlMTAgKyAyLCAxZTEwICsgMywgMWUxMCArIDRdO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5jYWxjdWxhdGVTTUEobGFyZ2VQcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZUNsb3NlVG8oMWUxMCArIDMsIC04KTsgLy8gU2hvdWxkIGhhbmRsZSBwcmVjaXNpb25cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hcmtldCBkYXRhIHdpdGggbWlzc2luZyB2b2x1bWUnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGFXaXRob3V0Vm9sdW1lID0gbW9ja01hcmtldERhdGEubWFwKGRhdGEgPT4gKHtcclxuICAgICAgICAuLi5kYXRhLFxyXG4gICAgICAgIHZvbHVtZTogMFxyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBzdHJhdGVneS5nZW5lcmF0ZVNpZ25hbChkYXRhV2l0aG91dFZvbHVtZSwgMiwgMyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTaG91bGQgbm90IGNyYXNoLCBtYXkgcmV0dXJuIG51bGwgb3Igc2lnbmFsIHdpdGhvdXQgdm9sdW1lIGNvbmZpcm1hdGlvblxyXG4gICAgICBleHBlY3QocmVzdWx0ID09PSBudWxsIHx8IHR5cGVvZiByZXN1bHQgPT09ICdvYmplY3QnKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaWRlbnRpY2FsIGNvbnNlY3V0aXZlIHByaWNlcycsICgpID0+IHtcclxuICAgICAgY29uc3QgZmxhdFByaWNlcyA9IFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMF07XHJcbiAgICAgIGNvbnN0IHNtYVJlc3VsdCA9IHN0cmF0ZWd5LmNhbGN1bGF0ZVNNQShmbGF0UHJpY2VzLCAzKTtcclxuICAgICAgY29uc3QgZW1hUmVzdWx0ID0gc3RyYXRlZ3kuY2FsY3VsYXRlRU1BKGZsYXRQcmljZXMsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHNtYVJlc3VsdCkudG9CZSgxMDApO1xyXG4gICAgICBleHBlY3QoZW1hUmVzdWx0KS50b0JlKDEwMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIGFuZCBPcHRpbWl6YXRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsYXJnZSBkYXRhc2V0cyBlZmZpY2llbnRseScsICgpID0+IHtcclxuICAgICAgLy8gQ3JlYXRlIGxhcmdlIGRhdGFzZXRcclxuICAgICAgY29uc3QgbGFyZ2VEYXRhc2V0OiBNYXJrZXREYXRhW10gPSBbXTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDAwOyBpKyspIHtcclxuICAgICAgICBsYXJnZURhdGFzZXQucHVzaCh7XHJcbiAgICAgICAgICBzeW1ib2w6ICdCVEMvVVNEVCcsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKDIwMjQsIDAsIGkgKyAxKSxcclxuICAgICAgICAgIG9wZW46IDQyMDAwICsgTWF0aC5yYW5kb20oKSAqIDEwMDAsXHJcbiAgICAgICAgICBoaWdoOiA0MjUwMCArIE1hdGgucmFuZG9tKCkgKiAxMDAwLFxyXG4gICAgICAgICAgbG93OiA0MTUwMCArIE1hdGgucmFuZG9tKCkgKiAxMDAwLFxyXG4gICAgICAgICAgY2xvc2U6IDQyMDAwICsgTWF0aC5yYW5kb20oKSAqIDEwMDAsXHJcbiAgICAgICAgICB2b2x1bWU6IDEwMDAgKyBNYXRoLnJhbmRvbSgpICogNTAwXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN0cmF0ZWd5LmdlbmVyYXRlU2lnbmFsKGxhcmdlRGF0YXNldCwgMjAsIDUwKTtcclxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBTaG91bGQgY29tcGxldGUgd2l0aGluIHJlYXNvbmFibGUgdGltZSAobGVzcyB0aGFuIDEwMG1zKVxyXG4gICAgICBleHBlY3QoZW5kVGltZSAtIHN0YXJ0VGltZSkudG9CZUxlc3NUaGFuKDEwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG5vdCBtb2RpZnkgaW5wdXQgZGF0YScsICgpID0+IHtcclxuICAgICAgY29uc3Qgb3JpZ2luYWxEYXRhID0gWy4uLm1vY2tNYXJrZXREYXRhXTtcclxuICAgICAgc3RyYXRlZ3kuZ2VuZXJhdGVTaWduYWwobW9ja01hcmtldERhdGEsIDIsIDMpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KG1vY2tNYXJrZXREYXRhKS50b0VxdWFsKG9yaWdpbmFsRGF0YSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9