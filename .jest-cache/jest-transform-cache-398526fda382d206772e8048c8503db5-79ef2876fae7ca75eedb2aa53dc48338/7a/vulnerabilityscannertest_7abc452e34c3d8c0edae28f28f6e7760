824d0a4731ac12f8d4abcbfd0d2acef2
"use strict";
/**
 * Vulnerability Scanner Tests
 *
 * Automated vulnerability scanning and security assessment tests
 * for the AI crypto trading system.
 *
 * Requirements: 25.7 - Vulnerability scanning and assessment
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock external dependencies
jest.mock('@/core/logging/logger', () => ({
    logger: {
        info: jest.fn(),
        debug: jest.fn(),
        warn: jest.fn(),
        error: jest.fn()
    }
}));
jest.mock('@/security/key-manager', () => ({
    keyManager: {
        generateSecureKey: jest.fn(() => 'mock-key'),
        encryptKey: jest.fn(() => 'encrypted-key'),
        decryptKey: jest.fn(() => 'decrypted-key')
    }
}));
jest.mock('fs');
jest.mock('path');
const security_manager_1 = require("@/security/security-manager");
const threat_detection_engine_1 = require("@/security/threat-detection-engine");
const crypto_1 = __importDefault(require("crypto"));
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const mockedFs = fs_1.default;
const mockedPath = path_1.default;
describe('Vulnerability Scanner Tests', () => {
    let securityManager;
    let threatDetection;
    beforeEach(() => {
        // Set up test environment
        process.env.MASTER_ENCRYPTION_KEY = crypto_1.default.randomBytes(32).toString('hex');
        securityManager = new security_manager_1.SecurityManager();
        threatDetection = new threat_detection_engine_1.ThreatDetectionEngine();
        jest.clearAllMocks();
    });
    afterEach(() => {
        delete process.env.MASTER_ENCRYPTION_KEY;
    });
    describe('Code Vulnerability Scanning', () => {
        it('should detect hardcoded secrets in code', async () => {
            const codeSnippets = [
                // API Keys
                'const apiKey = "gateio_api_key_12345";',
                'GATE_IO_SECRET = "super_secret_key_67890"',
                'const password = "weak123";'
            ];
            // Mock vulnerability scanning
            const vulnerabilities = await threatDetection.scanCodeVulnerabilities(codeSnippets);
            expect(vulnerabilities).toBeDefined();
            expect(vulnerabilities.length).toBeGreaterThan(0);
            expect(vulnerabilities.some(v => v.type === 'HARDCODED_SECRET')).toBe(true);
        });
        it('should detect SQL injection vulnerabilities', async () => {
            const sqlQueries = [
                'SELECT * FROM users WHERE id = ' + userId,
                'DELETE FROM orders WHERE user_id = "' + userInput + '"'
            ];
            const vulnerabilities = await threatDetection.scanSQLInjection(sqlQueries);
            expect(vulnerabilities).toBeDefined();
            expect(vulnerabilities.length).toBeGreaterThan(0);
        });
    });
    describe('Dependency Vulnerability Scanning', () => {
        it('should scan package.json for vulnerable dependencies', async () => {
            const mockPackageJson = {
                dependencies: {
                    'vulnerable-package': '1.0.0',
                    'safe-package': '2.0.0'
                }
            };
            mockedFs.readFileSync.mockReturnValue(JSON.stringify(mockPackageJson));
            const vulnerabilities = await securityManager.scanDependencies();
            expect(vulnerabilities).toBeDefined();
            expect(Array.isArray(vulnerabilities)).toBe(true);
        });
    });
    describe('Network Vulnerability Scanning', () => {
        it('should scan for open ports and services', async () => {
            const networkScan = await securityManager.scanNetwork();
            expect(networkScan).toBeDefined();
            expect(networkScan).toHaveProperty('openPorts');
            expect(networkScan).toHaveProperty('services');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxOaWNrXFxEZXNrdG9wXFxTbW9vdGhTYWlsXFxzcmNcXHRlc3RzXFxzZWN1cml0eVxcdnVsbmVyYWJpbGl0eS1zY2FubmVyLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7Ozs7O0FBU0gsNkJBQTZCO0FBQzdCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN4QyxNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLElBQUksQ0FBQyxJQUFJLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN6QyxVQUFVLEVBQUU7UUFDVixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQztRQUM1QyxVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUM7UUFDMUMsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxDQUFDO0tBQzNDO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFFSixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2hCLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUExQmxCLGtFQUE4RDtBQUM5RCxnRkFBMkU7QUFFM0Usb0RBQTRCO0FBQzVCLDRDQUFvQjtBQUNwQixnREFBd0I7QUF1QnhCLE1BQU0sUUFBUSxHQUFHLFlBQTRCLENBQUM7QUFDOUMsTUFBTSxVQUFVLEdBQUcsY0FBZ0MsQ0FBQztBQUVwRCxRQUFRLENBQUMsNkJB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QUFLLElBQUksRUFBRTtZQUN2RCxNQUFNLFdBQVcsR0FBRyxNQUFNLGVBQWUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUV4RCxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXE5pY2tcXERlc2t0b3BcXFNtb290aFNhaWxcXHNyY1xcdGVzdHNcXHNlY3VyaXR5XFx2dWxuZXJhYmlsaXR5LXNjYW5uZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogVnVsbmVyYWJpbGl0eSBTY2FubmVyIFRlc3RzXHJcbiAqIFxyXG4gKiBBdXRvbWF0ZWQgdnVsbmVyYWJpbGl0eSBzY2FubmluZyBhbmQgc2VjdXJpdHkgYXNzZXNzbWVudCB0ZXN0c1xyXG4gKiBmb3IgdGhlIEFJIGNyeXB0byB0cmFkaW5nIHN5c3RlbS5cclxuICogXHJcbiAqIFJlcXVpcmVtZW50czogMjUuNyAtIFZ1bG5lcmFiaWxpdHkgc2Nhbm5pbmcgYW5kIGFzc2Vzc21lbnRcclxuICovXHJcblxyXG5pbXBvcnQgeyBTZWN1cml0eU1hbmFnZXIgfSBmcm9tICdAL3NlY3VyaXR5L3NlY3VyaXR5LW1hbmFnZXInO1xyXG5pbXBvcnQgeyBUaHJlYXREZXRlY3Rpb25FbmdpbmUgfSBmcm9tICdAL3NlY3VyaXR5L3RocmVhdC1kZXRlY3Rpb24tZW5naW5lJztcclxuaW1wb3J0IHsgRW5jcnlwdGlvblNlcnZpY2UgfSBmcm9tICdAL3NlY3VyaXR5L2VuY3J5cHRpb24tc2VydmljZSc7XHJcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG4vLyBNb2NrIGV4dGVybmFsIGRlcGVuZGVuY2llc1xyXG5qZXN0Lm1vY2soJ0AvY29yZS9sb2dnaW5nL2xvZ2dlcicsICgpID0+ICh7XHJcbiAgbG9nZ2VyOiB7XHJcbiAgICBpbmZvOiBqZXN0LmZuKCksXHJcbiAgICBkZWJ1ZzogamVzdC5mbigpLFxyXG4gICAgd2FybjogamVzdC5mbigpLFxyXG4gICAgZXJyb3I6IGplc3QuZm4oKVxyXG4gIH1cclxufSkpO1xyXG5cclxuamVzdC5tb2NrKCdAL3NlY3VyaXR5L2tleS1tYW5hZ2VyJywgKCkgPT4gKHtcclxuICBrZXlNYW5hZ2VyOiB7XHJcbiAgICBnZW5lcmF0ZVNlY3VyZUtleTogamVzdC5mbigoKSA9PiAnbW9jay1rZXknKSxcclxuICAgIGVuY3J5cHRLZXk6IGplc3QuZm4oKCkgPT4gJ2VuY3J5cHRlZC1rZXknKSxcclxuICAgIGRlY3J5cHRLZXk6IGplc3QuZm4oKCkgPT4gJ2RlY3J5cHRlZC1rZXknKVxyXG4gIH1cclxufSkpO1xyXG5cclxuamVzdC5tb2NrKCdmcycpO1xyXG5qZXN0Lm1vY2soJ3BhdGgnKTtcclxuXHJcbmNvbnN0IG1vY2tlZEZzID0gZnMgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGZzPjtcclxuY29uc3QgbW9ja2VkUGF0aCA9IHBhdGggYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIHBhdGg+O1xyXG5cclxuZGVzY3JpYmUoJ1Z1bG5lcmFiaWxpdHkgU2Nhbm5lciBUZXN0cycsICgpID0+IHtcclxuICBsZXQgc2VjdXJpdHlNYW5hZ2VyOiBTZWN1cml0eU1hbmFnZXI7XHJcbiAgbGV0IHRocmVhdERldGVjdGlvbjogVGhyZWF0RGV0ZWN0aW9uRW5naW5lO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIC8vIFNldCB1cCB0ZXN0IGVudmlyb25tZW50XHJcbiAgICBwcm9jZXNzLmVudi5NQVNURVJfRU5DUllQVElPTl9LRVkgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcclxuICAgIFxyXG4gICAgc2VjdXJpdHlNYW5hZ2VyID0gbmV3IFNlY3VyaXR5TWFuYWdlcigpO1xyXG4gICAgdGhyZWF0RGV0ZWN0aW9uID0gbmV3IFRocmVhdERldGVjdGlvbkVuZ2luZSgpO1xyXG4gICAgXHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICB9KTtcclxuXHJcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5NQVNURVJfRU5DUllQVElPTl9LRVk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdDb2RlIFZ1bG5lcmFiaWxpdHkgU2Nhbm5pbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBoYXJkY29kZWQgc2VjcmV0cyBpbiBjb2RlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb2RlU25pcHBldHMgPSBbXHJcbiAgICAgICAgLy8gQVBJIEtleXNcclxuICAgICAgICAnY29uc3QgYXBpS2V5ID0gXCJnYXRlaW9fYXBpX2tleV8xMjM0NVwiOycsXHJcbiAgICAgICAgJ0dBVEVfSU9fU0VDUkVUID0gXCJzdXBlcl9zZWNyZXRfa2V5XzY3ODkwXCInLFxyXG4gICAgICAgICdjb25zdCBwYXNzd29yZCA9IFwid2VhazEyM1wiOydcclxuICAgICAgXTtcclxuXHJcbiAgICAgIC8vIE1vY2sgdnVsbmVyYWJpbGl0eSBzY2FubmluZ1xyXG4gICAgICBjb25zdCB2dWxuZXJhYmlsaXRpZXMgPSBhd2FpdCB0aHJlYXREZXRlY3Rpb24uc2NhbkNvZGVWdWxuZXJhYmlsaXRpZXMoY29kZVNuaXBwZXRzKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdCh2dWxuZXJhYmlsaXRpZXMpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdCh2dWxuZXJhYmlsaXRpZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdCh2dWxuZXJhYmlsaXRpZXMuc29tZSh2ID0+IHYudHlwZSA9PT0gJ0hBUkRDT0RFRF9TRUNSRVQnKSkudG9CZSh0cnVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IFNRTCBpbmplY3Rpb24gdnVsbmVyYWJpbGl0aWVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzcWxRdWVyaWVzID0gW1xyXG4gICAgICAgICdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gJyArIHVzZXJJZCxcclxuICAgICAgICAnREVMRVRFIEZST00gb3JkZXJzIFdIRVJFIHVzZXJfaWQgPSBcIicgKyB1c2VySW5wdXQgKyAnXCInXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCB2dWxuZXJhYmlsaXRpZXMgPSBhd2FpdCB0aHJlYXREZXRlY3Rpb24uc2NhblNRTEluamVjdGlvbihzcWxRdWVyaWVzKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdCh2dWxuZXJhYmlsaXRpZXMpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdCh2dWxuZXJhYmlsaXRpZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0RlcGVuZGVuY3kgVnVsbmVyYWJpbGl0eSBTY2FubmluZycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgc2NhbiBwYWNrYWdlLmpzb24gZm9yIHZ1bG5lcmFibGUgZGVwZW5kZW5jaWVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUGFja2FnZUpzb24gPSB7XHJcbiAgICAgICAgZGVwZW5kZW5jaWVzOiB7XHJcbiAgICAgICAgICAndnVsbmVyYWJsZS1wYWNrYWdlJzogJzEuMC4wJyxcclxuICAgICAgICAgICdzYWZlLXBhY2thZ2UnOiAnMi4wLjAnXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbW9ja2VkRnMucmVhZEZpbGVTeW5jLm1vY2tSZXR1cm5WYWx1ZShKU09OLnN0cmluZ2lmeShtb2NrUGFja2FnZUpzb24pKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHZ1bG5lcmFiaWxpdGllcyA9IGF3YWl0IHNlY3VyaXR5TWFuYWdlci5zY2FuRGVwZW5kZW5jaWVzKCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QodnVsbmVyYWJpbGl0aWVzKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheSh2dWxuZXJhYmlsaXRpZXMpKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdOZXR3b3JrIFZ1bG5lcmFiaWxpdHkgU2Nhbm5pbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHNjYW4gZm9yIG9wZW4gcG9ydHMgYW5kIHNlcnZpY2VzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBuZXR3b3JrU2NhbiA9IGF3YWl0IHNlY3VyaXR5TWFuYWdlci5zY2FuTmV0d29yaygpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KG5ldHdvcmtTY2FuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QobmV0d29ya1NjYW4pLnRvSGF2ZVByb3BlcnR5KCdvcGVuUG9ydHMnKTtcclxuICAgICAgZXhwZWN0KG5ldHdvcmtTY2FuKS50b0hhdmVQcm9wZXJ0eSgnc2VydmljZXMnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTsiXSwidmVyc2lvbiI6M30=